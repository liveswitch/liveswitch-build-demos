import{d as pe,e as Ce,f as ke,i as et,r as x,w as Ve,o as Ae,j as w,k as U,l as o,b as s,t as q,C as Q,s as p,q as u,B as K,D as se,F as ce,E as ue,n as G,G as tt,v as at,x as xe,y as we,a as ve,m as Se,H as Ge,u as me,p as he,I as de,J as Ie,K as nt,L as st,M as O,N as lt,O as it,P as ot,Q as ne,R as ge,S as ct,A as Fe,T as Oe,U as ut,V as dt,W as rt,X as vt,Y as ae,Z as mt,z as C,_ as Z}from"./index-db39c6f0.js";import{_ as Ye,V as _e,e as M,a as re,d as J,b as Me,g as Le,h as Te,i as Re,j as Ue,k as be,l as ft,n as gt,o as ht,p as pt,q as St,r as _t,s as bt,t as yt,u as Ct,R as kt,v as Vt,w as At,x as We,y as xt,z as wt,A as It,B as Mt,C as Lt,D as Tt,E as Rt,L as Pt,F as Dt,G as $t,H as Ot,I as Ut,J as zt,K as Nt,M as Bt,N as ze,O as Ne,P as Ht,Q as je,S as ee,T as Xe}from"./_plugin-vue_export-helper-10707ec3.js";const qe=e=>(xe("data-v-bb1c8dff"),e=e(),we(),e),Et={class:"container"},Gt={class:"left-column"},Ft={class:"flex-center"},Yt={class:"row-spread"},Wt={class:"user-counter"},jt=qe(()=>o("i",{class:"icon-users users"},null,-1)),Xt={class:"video-grid"},qt={class:"right-column"},Kt={class:"settings-menu"},Qt={class:"row"},Jt={class:"row"},Zt={class:"row"},ea={class:"chat-container"},ta=qe(()=>o("div",{class:"chat-header"},[o("h2",{class:"margin"},"Chat")],-1)),aa={class:"chat-body"},na={class:"chat-footer"},sa=pe({__name:"InCall",setup(e){const t=Ce(),d=ke(),i=et("liveSwitch");let I=x([]);const v=x(""),g=x(1);let l=x("100%");Ve(g,function(){const V=Math.ceil(Math.sqrt(g.value)),_=100/V;l.value="calc("+_+"% - "+V*5+"px)"});const r=t.state.localMedia;let m=null,f=null,y=x({});const h=x("");let k=x([]);async function z(){await i.disconnectFromMeeting(y.value,f,r),r.destroy(),t.commit("resetStore"),d.push("/")}function H(V){debugger}function $(V){y.value[V.getId()].remoteMedia.destroy(),delete y.value[V.getId()],g.value--}function R(){h.value.length!==0&&(i.sendChat(m,t.state.displayName,h.value),h.value="")}function L(V,_){let b=V.getRemoteConnectionInfo().getUserAlias();y.value[V.getId()]={connection:V,remoteMedia:_,index:g.value++,displayName:b},i.createDownStreamCloseHandler(V,$)}Ae(async()=>{f=await i.registerClient(t.state.displayName,t.state.channelId),m=await i.getChannel(f),i.openSfuUpstreamConnection(t.state.localMedia,m),i.createDownStreamOpenHandler(m,L),t.commit("setLocalMedia",r),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",r.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",r.getAudioSourceInput().getId()),t.commit("setVideoMuted",r.getVideoMuted()),t.commit("setAudioMuted",r.getAudioMuted()),i.addIncomingChatHandler(m,P)});function P(V){var _=JSON.parse(V);k.value.push({user:_.from,message:_.text})}return(V,_)=>(w(),U("div",Et,[o("div",Gt,[o("div",Ft,[s(_e,{src:Ye,class:"logo"})]),o("div",Yt,[o("div",Wt,[jt,q(" "+Q(g.value),1)]),s(M,{class:"leave-button",onClick:z},{default:p(()=>[q("Leave Call")]),_:1})]),o("div",Xt,[u(t).state.localMedia?(w(),K(re,{key:0,class:"video","local-video":u(t).state.localMedia,userName:"Me",askHeight:u(l),askWidth:u(l)},null,8,["local-video","askHeight","askWidth"])):se("",!0),u(y)?(w(!0),U(ce,{key:1},ue(u(y),b=>(w(),K(re,{class:"video",remoteVideo:b.remoteMedia,index:b.index,userName:b.displayName,connection:b.connection,askHeight:u(l),askWidth:u(l)},null,8,["remoteVideo","index","userName","connection","askHeight","askWidth"]))),256)):se("",!0)])]),o("div",qt,[o("div",Kt,[o("div",Qt,[s(J,{label:"Camera",class:"margin input","hide-details":"auto",items:u(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeVideoDevice,"onUpdate:modelValue":[_[0]||(_[0]=b=>u(t).state.activeVideoDevice=b),_[1]||(_[1]=b=>u(t).commit("changeCamera"))]},null,8,["items","modelValue"]),s(M,{class:"margin button",icon:"",onClick:_[2]||(_[2]=b=>u(t).commit("toggleLocalVideoMute"))},{default:p(()=>[o("i",{class:G(["center",u(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1})]),o("div",Jt,[s(J,{label:"Microphone",class:"margin input","hide-details":"auto",items:u(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeAudioDevice,"onUpdate:modelValue":[_[3]||(_[3]=b=>u(t).state.activeAudioDevice=b),_[4]||(_[4]=b=>u(t).commit("changeMicrophone"))]},null,8,["items","modelValue"]),s(M,{class:"margin button",icon:"",onClick:_[5]||(_[5]=b=>u(t).commit("toggleLocalAudioMute"))},{default:p(()=>[o("i",{class:G(["center",u(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1})]),o("div",Zt,[u(I).length>0?(w(),K(J,{key:0,label:"Speaker",class:"margin input","hide-details":"auto",items:u(I),"item-title":"name","item-value":"id",modelValue:v.value,"onUpdate:modelValue":[_[6]||(_[6]=b=>v.value=b),H]},null,8,["items","modelValue"])):se("",!0)])]),o("div",ea,[ta,o("div",aa,[(w(!0),U(ce,null,ue(u(k),b=>(w(),U("div",null,[o("div",{class:G(["chat-message",b.user===u(t).state.displayName?"my-chat":"other-chat"])},Q(b.user)+": "+Q(b.message),3)]))),256))]),o("div",na,[s(Me,{label:"Chat Message",clearable:"",class:"margin chat-input","hide-details":"auto",modelValue:h.value,"onUpdate:modelValue":_[7]||(_[7]=b=>h.value=b),onKeydown:tt(at(R,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),s(M,{class:"chat-button",onClick:R},{default:p(()=>[q(" Send ")]),_:1})])])])]))}});const la=Le(sa,[["__scopeId","data-v-bb1c8dff"]]);const ia=ve()({name:"VCardActions",props:Se(),setup(e,t){let{slots:d}=t;return Ge({VBtn:{variant:"text"}}),me(()=>{var i;return s("div",{class:["v-card-actions",e.class],style:e.style},[(i=d.default)==null?void 0:i.call(d)])}),{}}}),oa=Te("v-card-subtitle"),ca=Te("v-card-title"),ua=he({appendAvatar:String,appendIcon:de,prependAvatar:String,prependIcon:de,subtitle:String,title:String,...Se(),...Re()},"VCardItem"),da=ve()({name:"VCardItem",props:ua(),setup(e,t){let{slots:d}=t;return me(()=>{var m;const i=!!(e.prependAvatar||e.prependIcon),I=!!(i||d.prepend),v=!!(e.appendAvatar||e.appendIcon),g=!!(v||d.append),l=!!(e.title||d.title),r=!!(e.subtitle||d.subtitle);return s("div",{class:["v-card-item",e.class],style:e.style},[I&&s("div",{key:"prepend",class:"v-card-item__prepend"},[d.prepend?s(be,{key:"prepend-defaults",disabled:!i,defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar}}},d.prepend):i&&s(Ue,{key:"prepend-avatar",density:e.density,icon:e.prependIcon,image:e.prependAvatar},null)]),s("div",{class:"v-card-item__content"},[l&&s(ca,{key:"title"},{default:()=>{var f;return[((f=d.title)==null?void 0:f.call(d))??e.title]}}),r&&s(oa,{key:"subtitle"},{default:()=>{var f;return[((f=d.subtitle)==null?void 0:f.call(d))??e.subtitle]}}),(m=d.default)==null?void 0:m.call(d)]),g&&s("div",{key:"append",class:"v-card-item__append"},[d.append?s(be,{key:"append-defaults",disabled:!v,defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar}}},d.append):v&&s(Ue,{key:"append-avatar",density:e.density,icon:e.appendIcon,image:e.appendAvatar},null)])])}),{}}}),ra=Te("v-card-text"),va=he({appendAvatar:String,appendIcon:de,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:de,ripple:{type:[Boolean,Object],default:!0},subtitle:String,text:String,title:String,...ft(),...Se(),...Re(),...gt(),...ht(),...pt(),...St(),..._t(),...bt(),...yt(),...Ie(),...nt(),...Ct({variant:"elevated"})},"VCard"),Ke=ve()({name:"VCard",directives:{Ripple:kt},props:va(),setup(e,t){let{attrs:d,slots:i}=t;const{themeClasses:I}=st(e),{borderClasses:v}=Vt(e),{colorClasses:g,colorStyles:l,variantClasses:r}=At(e),{densityClasses:m}=We(e),{dimensionStyles:f}=xt(e),{elevationClasses:y}=wt(e),{loaderClasses:h}=It(e),{locationStyles:k}=Mt(e),{positionClasses:z}=Lt(e),{roundedClasses:H}=Tt(e),$=Rt(e,d),R=O(()=>e.link!==!1&&$.isLink.value),L=O(()=>!e.disabled&&e.link!==!1&&(e.link||$.isClickable.value));return me(()=>{const P=R.value?"a":e.tag,V=!!(i.title||e.title),_=!!(i.subtitle||e.subtitle),b=V||_,E=!!(i.append||e.appendAvatar||e.appendIcon),F=!!(i.prepend||e.prependAvatar||e.prependIcon),W=!!(i.image||e.image),N=b||F||E,c=!!(i.text||e.text);return lt(s(P,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":L.value},I.value,v.value,g.value,m.value,y.value,h.value,z.value,H.value,r.value,e.class],style:[l.value,f.value,k.value,e.style],href:$.href.value,onClick:L.value&&$.navigate,tabindex:e.disabled?-1:void 0},{default:()=>{var n;return[W&&s("div",{key:"image",class:"v-card__image"},[i.image?s(be,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},i.image):s(_e,{key:"image-img",cover:!0,src:e.image},null)]),s(Pt,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:i.loader}),N&&s(da,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:i.item,prepend:i.prepend,title:i.title,subtitle:i.subtitle,append:i.append}),c&&s(ra,{key:"text"},{default:()=>{var a;return[((a=i.text)==null?void 0:a.call(i))??e.text]}}),(n=i.default)==null?void 0:n.call(i),i.actions&&s(ia,null,{default:i.actions}),Dt(L.value,"v-card")]}}),[[it("ripple"),L.value&&e.ripple]])}),{}}});const Qe=Symbol.for("vuetify:v-tabs"),ma=he({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...ot($t({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),ye=ve()({name:"VTab",props:ma(),setup(e,t){let{slots:d,attrs:i}=t;const{textColorClasses:I,textColorStyles:v}=Ot(e,"sliderColor"),g=O(()=>e.direction==="horizontal"),l=ne(!1),r=x(),m=x();function f(y){var k,z;let{value:h}=y;if(l.value=h,h){const H=(z=(k=r.value)==null?void 0:k.$el.parentElement)==null?void 0:z.querySelector(".v-tab--selected .v-tab__slider"),$=m.value;if(!H||!$)return;const R=getComputedStyle(H).color,L=H.getBoundingClientRect(),P=$.getBoundingClientRect(),V=g.value?"x":"y",_=g.value?"X":"Y",b=g.value?"right":"bottom",E=g.value?"width":"height",F=L[V],W=P[V],N=F>W?L[b]-P[b]:L[V]-P[V],c=Math.sign(N)>0?g.value?"right":"bottom":Math.sign(N)<0?g.value?"left":"top":"center",a=(Math.abs(N)+(Math.sign(N)<0?L[E]:P[E]))/Math.max(L[E],P[E])||0,D=L[E]/P[E]||0,Y=1.5;Ut($,{backgroundColor:[R,"currentcolor"],transform:[`translate${_}(${N}px) scale${_}(${D})`,`translate${_}(${N/Y}px) scale${_}(${(a-1)/Y+1})`,"none"],transformOrigin:Array(3).fill(c)},{duration:225,easing:zt})}}return me(()=>{const[y]=M.filterProps(e);return s(M,ge({symbol:Qe,ref:r,class:["v-tab",e.class],style:e.style,tabindex:l.value?0:-1,role:"tab","aria-selected":String(l.value),active:!1},y,i,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":f}),{default:()=>{var h;return[((h=d.default)==null?void 0:h.call(d))??e.text,!e.hideSlider&&s("div",{ref:m,class:["v-tab__slider",I.value],style:v.value},null)]}})}),{}}});function Be(e){const d=Math.abs(e);return Math.sign(e)*(d/((1/.501-2)*(1-d)+1))}function He(e){let{selectedElement:t,containerSize:d,contentSize:i,isRtl:I,currentScrollOffset:v,isHorizontal:g}=e;const l=g?t.clientWidth:t.clientHeight,r=g?t.offsetLeft:t.offsetTop,m=I&&g?i-r-l:r,f=d+v,y=l+m,h=l*.4;return m<=v?v=Math.max(m-h,0):f<=y&&(v=Math.min(v-(f-y-h),i-d)),v}function fa(e){let{selectedElement:t,containerSize:d,contentSize:i,isRtl:I,isHorizontal:v}=e;const g=v?t.clientWidth:t.clientHeight,l=v?t.offsetLeft:t.offsetTop,r=I&&v?i-l-g/2-d/2:l+g/2-d/2;return Math.min(i-d,Math.max(0,r))}const ga=Symbol.for("vuetify:v-slide-group"),Je=he({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:ga},nextIcon:{type:de,default:"$next"},prevIcon:{type:de,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...Se(),...Ie(),...Nt({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),Ee=ve()({name:"VSlideGroup",props:Je(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:d}=t;const{isRtl:i}=ct(),{mobile:I}=Fe(),v=Bt(e,e.symbol),g=ne(!1),l=ne(0),r=ne(0),m=ne(0),f=O(()=>e.direction==="horizontal"),{resizeRef:y,contentRect:h}=Oe(),{resizeRef:k,contentRect:z}=Oe(),H=O(()=>v.selected.value.length?v.items.value.findIndex(S=>S.id===v.selected.value[0]):-1),$=O(()=>v.selected.value.length?v.items.value.findIndex(S=>S.id===v.selected.value[v.selected.value.length-1]):-1);if(ut){let S=-1;Ve(()=>[v.selected.value,h.value,z.value,f.value],()=>{cancelAnimationFrame(S),S=requestAnimationFrame(()=>{if(h.value&&z.value){const A=f.value?"width":"height";r.value=h.value[A],m.value=z.value[A],g.value=r.value+1<m.value}if(H.value>=0&&k.value){const A=k.value.children[$.value];H.value===0||!g.value?l.value=0:e.centerActive?l.value=fa({selectedElement:A,containerSize:r.value,contentSize:m.value,isRtl:i.value,isHorizontal:f.value}):g.value&&(l.value=He({selectedElement:A,containerSize:r.value,contentSize:m.value,isRtl:i.value,currentScrollOffset:l.value,isHorizontal:f.value}))}})})}const R=ne(!1);let L=0,P=0;function V(S){const A=f.value?"clientX":"clientY";P=(i.value&&f.value?-1:1)*l.value,L=S.touches[0][A],R.value=!0}function _(S){if(!g.value)return;const A=f.value?"clientX":"clientY",X=i.value&&f.value?-1:1;l.value=X*(P+L-S.touches[0][A])}function b(S){const A=m.value-r.value;l.value<0||!g.value?l.value=0:l.value>=A&&(l.value=A),R.value=!1}function E(){y.value&&(y.value[f.value?"scrollLeft":"scrollTop"]=0)}const F=ne(!1);function W(S){if(F.value=!0,!(!g.value||!k.value)){for(const A of S.composedPath())for(const X of k.value.children)if(X===A){l.value=He({selectedElement:X,containerSize:r.value,contentSize:m.value,isRtl:i.value,currentScrollOffset:l.value,isHorizontal:f.value});return}}}function N(S){F.value=!1}function c(S){var A;!F.value&&!(S.relatedTarget&&((A=k.value)!=null&&A.contains(S.relatedTarget)))&&a()}function n(S){k.value&&(f.value?S.key==="ArrowRight"?a(i.value?"prev":"next"):S.key==="ArrowLeft"&&a(i.value?"next":"prev"):S.key==="ArrowDown"?a("next"):S.key==="ArrowUp"&&a("prev"),S.key==="Home"?a("first"):S.key==="End"&&a("last"))}function a(S){var A,X,Pe,De,$e;if(k.value)if(!S)(A=dt(k.value)[0])==null||A.focus();else if(S==="next"){const le=(X=k.value.querySelector(":focus"))==null?void 0:X.nextElementSibling;le?le.focus():a("first")}else if(S==="prev"){const le=(Pe=k.value.querySelector(":focus"))==null?void 0:Pe.previousElementSibling;le?le.focus():a("last")}else S==="first"?(De=k.value.firstElementChild)==null||De.focus():S==="last"&&(($e=k.value.lastElementChild)==null||$e.focus())}function D(S){const A=l.value+(S==="prev"?-1:1)*r.value;l.value=rt(A,0,m.value-r.value)}const Y=O(()=>{let S=l.value>m.value-r.value?-(m.value-r.value)+Be(m.value-r.value-l.value):-l.value;l.value<=0&&(S=Be(-l.value));const A=i.value&&f.value?-1:1;return{transform:`translate${f.value?"X":"Y"}(${A*S}px)`,transition:R.value?"none":"",willChange:R.value?"transform":""}}),T=O(()=>({next:v.next,prev:v.prev,select:v.select,isSelected:v.isSelected})),B=O(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!I.value;case!0:return g.value||Math.abs(l.value)>0;case"mobile":return I.value||g.value||Math.abs(l.value)>0;default:return!I.value&&(g.value||Math.abs(l.value)>0)}}),j=O(()=>Math.abs(l.value)>0),Ze=O(()=>m.value>Math.abs(l.value)+r.value);return me(()=>s(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!f.value,"v-slide-group--has-affixes":B.value,"v-slide-group--is-overflowing":g.value},e.class],style:e.style,tabindex:F.value||v.selected.value.length?-1:0,onFocus:c},{default:()=>{var S,A,X;return[B.value&&s("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!j.value}],onClick:()=>D("prev")},[((S=d.prev)==null?void 0:S.call(d,T.value))??s(ze,null,{default:()=>[s(Ne,{icon:i.value?e.nextIcon:e.prevIcon},null)]})]),s("div",{key:"container",ref:y,class:"v-slide-group__container",onScroll:E},[s("div",{ref:k,class:"v-slide-group__content",style:Y.value,onTouchstartPassive:V,onTouchmovePassive:_,onTouchendPassive:b,onFocusin:W,onFocusout:N,onKeydown:n},[(A=d.default)==null?void 0:A.call(d,T.value)])]),B.value&&s("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!Ze.value}],onClick:()=>D("next")},[((X=d.next)==null?void 0:X.call(d,T.value))??s(ze,null,{default:()=>[s(Ne,{icon:i.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:v.selected,scrollTo:D,scrollOffset:l,focus:a}}});function ha(e){return e?e.map(t=>typeof t=="string"?{title:t,value:t}:t):[]}const pa=he({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Je({mandatory:"force"}),...Re(),...Ie()},"VTabs"),Sa=ve()({name:"VTabs",props:pa(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:d}=t;const i=vt(e,"modelValue"),I=O(()=>ha(e.items)),{densityClasses:v}=We(e),{backgroundColorClasses:g,backgroundColorStyles:l}=Ht(ae(e,"bgColor"));return Ge({VTab:{color:ae(e,"color"),direction:ae(e,"direction"),stacked:ae(e,"stacked"),fixed:ae(e,"fixedTabs"),sliderColor:ae(e,"sliderColor"),hideSlider:ae(e,"hideSlider")}}),me(()=>{const[r]=Ee.filterProps(e);return s(Ee,ge(r,{modelValue:i.value,"onUpdate:modelValue":m=>i.value=m,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},v.value,g.value,e.class],style:[{"--v-tabs-height":mt(e.height)},l.value,e.style],role:"tablist",symbol:Qe}),{default:()=>[d.default?d.default():I.value.map(m=>s(ye,ge(m,{key:m.title}),null))]})}),{}}}),fe=e=>(xe("data-v-e2c6dad3"),e=e(),we(),e),_a={class:"container"},ba={class:"column"},ya={class:"margin spread"},Ca={class:"row"},ka=fe(()=>o("i",{class:"center icon-cog-gear"},null,-1)),Va=fe(()=>o("h3",null,"Settings",-1)),Aa={class:"users-container"},xa=fe(()=>o("i",{class:"icon-users users"},null,-1)),wa={class:"button-wrapper"},Ia={class:"tab-container"},Ma={key:0},La={class:"basic-flex"},Ta={class:"even-spacing"},Ra={class:"video-container"},Pa={class:"video-container"},Da={class:"controls-container"},$a=fe(()=>o("i",{class:"center icon-caret-left-md"},null,-1)),Oa={class:"row-center"},Ua=fe(()=>o("i",{class:"center icon-caret-right-md"},null,-1)),za={key:1,class:"chat-container"},Na=fe(()=>o("div",{class:"chat-header"},[o("h3",null,"Chat")],-1)),Ba={class:"chat-body"},Ha={class:"chat-footer"},Ea={class:"tab-buttons"},ie=2,Ga=pe({__name:"InCallPortrait",setup(e){const t=Ce(),d=ke(),i=O(()=>t.state.pinLocal||r.value===1),I=O(()=>{let c=1;return t.state.pinLocal?c=l.value-1:c=Math.ceil(l.value/ie),c});Ve(t.state.pinLocal,R);let v=x([]);const g=x(""),l=x(1),r=x(1),m=t.state.localMedia;let f=null,y=null,h=x({});const k=x("");let z=x([]);function H(){r.value*ie-1<l.value&&(r.value++,R())}function $(){r.value>1&&(r.value--,R())}function R(){let c=new Array;if(t.state.pinLocal||r.value===1)for(let n in h.value){let a=h.value[n];a.index===r.value&&c.push(a)}else for(let n in h.value){let a=h.value[n];(a.index===r.value*ie-ie||a.index===r.value*ie-1)&&c.push(a)}t.commit("setVideoList",c)}function L(){for(let c in h.value){const n=h.value[c].connection;(n.getState()!==C.ConnectionState.Closed.valueOf()||n.getState()!==C.ConnectionState.Closing)&&n.close(),delete h.value[c]}F(),d.push("/")}function P(){if(k.value.length===0)return;let c=new Date;var n={from:t.state.displayName,timestamp:new Date().getTime(),timestampHourFormat:c.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),timestampDateFormat:c.toLocaleString(),text:k.value};f&&f.sendMessage(JSON.stringify(n)),k.value=""}Ae(async()=>{await V(),t.commit("setLocalMedia",m),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",m.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",m.getAudioSourceInput().getId()),t.commit("setVideoMuted",m.getVideoMuted()),t.commit("setAudioMuted",m.getAudioMuted()),f&&f.addOnMessage(function(c,n){var a=JSON.parse(n);console.log(n),z.value.push({user:a.from,message:a.text})})});async function V(){const c=new C.Promise;y=new C.Client(Z.gatewayUrl,Z.applicationId),y.setUserAlias(t.state.displayName);const n=C.Token.generateClientRegisterToken(Z.applicationId,y.getUserId(),y.getDeviceId(),y.getId(),[new C.ChannelClaim(t.state.channelId)],Z.sharedSecret);return y.register(n).then(a=>{_(a),c.resolve(null)}).fail(a=>{C.Log.error("Failed to register with Gateway."),c.reject(a)}),c}function _(c){f=c[0];const n=E(t.state.localMedia);t.commit("setUpstreamConnection",n),f&&f.addOnRemoteUpstreamConnectionOpen(a=>b(a,f))}function b(c,n){const a=new C.RemoteMedia,D=new C.AudioStream(a),Y=new C.VideoStream(a);if(n){const T=n.createSfuDownstreamConnection(c,D,Y);return l.value===1&&t.commit("setVideoList",[{connection:T,media:a,index:l.value,displayName:c.getUserAlias()}]),h.value[T.getId()]={connection:T,media:a,index:l.value++,displayName:c.getUserAlias()},v.value.length===0&&a.getAudioSinkOutputs().then(function(B){v.value=B.map(j=>(j.getId()==="default"&&(g.value=j.getId()),{name:j.getName(),id:j.getId()}))}).fail(function(B){console.error(B)}),T.addOnStateChange(B=>{B.getRemoteClosed()&&(delete h.value[T.getId()],a.destroy(),l.value--)}),T.open(),T}}function E(c){const n=new C.AudioStream(c),a=new C.VideoStream(c);if(!f)return;const D=f.createSfuUpstreamConnection(n,a);return D.addOnStateChange(Y=>{C.Log.debug(`Upstream connection is ${new C.ConnectionStateWrapper(Y.getState()).toString()}.`)}),D.open(),D}function F(){if(y)return y.unregister().fail(()=>C.Log.error("Unregistration failed."))}const W=x("GALLERY");function N(c){W.value=c.target.innerText}return(c,n)=>(w(),U("div",_a,[o("div",ba,[s(_e,{src:Ye,class:"logo"}),o("div",ya,[o("div",Ca,[s(Xe,{"close-on-content-click":!1,location:"bottom"},{activator:p(({props:a})=>[s(M,ge(a,{icon:"",class:"icon",flat:""}),{default:p(()=>[ka]),_:2},1040)]),default:p(()=>[s(Ke,{class:"settings-menu"},{default:p(()=>[s(je,null,{default:p(()=>[s(ee,null,{default:p(()=>[Va]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Camera",class:"margin input","hide-details":"auto",items:u(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeVideoDevice,"onUpdate:modelValue":[n[0]||(n[0]=a=>u(t).state.activeVideoDevice=a),n[1]||(n[1]=a=>u(t).commit("changeCamera"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Microphone",class:"margin input","hide-details":"auto",items:u(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeAudioDevice,"onUpdate:modelValue":[n[2]||(n[2]=a=>u(t).state.activeAudioDevice=a),n[3]||(n[3]=a=>u(t).commit("changeMicrophone"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Speaker",class:"margin input","hide-details":"auto"})]),_:1})]),_:1})]),_:1})]),_:1}),o("div",Aa,[xa,q(" "+Q(l.value),1)])]),o("div",wa,[s(M,{class:"leave-button",onClick:L},{default:p(()=>[q("Leave")]),_:1})])]),o("div",Ia,[W.value==="GALLERY"?(w(),U("div",Ma,[o("div",La,[o("div",Ta,[o("div",Ra,[u(t).state.localMedia&&i.value?(w(),K(re,{key:0,"ask-height":"240px","ask-width":"320px","local-video":u(t).state.localMedia,userName:"Me"},null,8,["local-video"])):se("",!0)]),o("div",Pa,[u(t).state.videoList?(w(!0),U(ce,{key:0},ue(u(t).state.videoList,a=>(w(),K(re,{remoteVideo:a.media,index:a.index,userName:a.displayName,connection:a.connection,"ask-height":"240px","ask-width":"320px",maxIndex:ie},null,8,["remoteVideo","index","userName","connection"]))),256)):se("",!0)])])]),o("div",Da,[s(M,{class:G(["margin align-left",r.value===1?"inactive-button":"active-button"]),icon:"",onClick:$},{default:p(()=>[$a]),_:1},8,["class"]),o("div",Oa,[s(M,{class:"margin active-button",icon:"",onClick:n[4]||(n[4]=a=>u(t).commit("toggleLocalVideoMute"))},{default:p(()=>[o("i",{class:G(["center",u(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1}),s(M,{class:"margin active-button",icon:"",onClick:n[5]||(n[5]=a=>u(t).commit("toggleLocalAudioMute"))},{default:p(()=>[o("i",{class:G(["center",u(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1})]),s(M,{class:G(["margin active-button align-right",r.value===I.value?"inactive-button":"active-button"]),icon:"",onClick:H},{default:p(()=>[Ua]),_:1},8,["class"])])])):(w(),U("div",za,[Na,o("div",Ba,[(w(!0),U(ce,null,ue(u(z),a=>(w(),U("div",null,[o("div",{class:G(["chat-message",a.user===u(t).state.displayName?"my-chat":"other-chat"])},Q(a.user)+": "+Q(a.message),3)]))),256))]),o("div",Ha,[s(Me,{label:"Chat Message",clearable:"",class:"margin chat-input","hide-details":"auto",modelValue:k.value,"onUpdate:modelValue":n[6]||(n[6]=a=>k.value=a)},null,8,["modelValue"]),s(M,{class:"chat-button",onClick:P},{default:p(()=>[q("Send")]),_:1})])]))]),o("div",Ea,[s(Sa,{"fixed-tabs":"","selected-class":"activeTab",class:"tabs",onClick:N},{default:p(()=>[s(ye,{value:"gallery"},{default:p(()=>[q("Gallery")]),_:1}),s(ye,{value:"chat"},{default:p(()=>[q("Chat")]),_:1})]),_:1})])])]))}});const Fa=Le(Ga,[["__scopeId","data-v-e2c6dad3"]]),Ya="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAzCAYAAADVY1sUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATLSURBVHgBzVrtcdw2EH3U+L/jCkKlgERxA6bVQKQKxLgB0S4goSqQ1EBySgGR3UDCVCC5gYgd+FwBjMclxY8jsCB5N3dvBpwTAQJ8u4vdxVIRDgGZ4fU7RLiAwZn9fVL9LXis2x1uosI1RYR9Q0j8zl9oX96Ff217ZwmVw479ERECx7b9DdFAKIx9619xHd11b+6HSEviH9tiTMcGmTAimaHE2Na2FVa1a8xFOIkb264g5pZCzK+LL7a9bszsBdwLcoJL9G13bR98hWWg8P6An8SVXSd/XjMzJPTGtqQz5lU9zyn/OBqdJjOxvT7YlqO/AUssQbuxE8+opw6JLj6P3EtqgY8QERL0DvHIg/NNSkCTuvT0k+k7x/3PjmdSXsY0kmPeBgwBteFzsaUvVoyAZvojf/SJiDYusAvoc9MTXXn6XQKIeRlqJMHukKsjDP7z9L709G0Q0QJTjPl4o/R/GovYNWhCP3me3SCipQhx4yUmITNn8AuBZvURfriE/JWXIZEQrzQlnWig7bv1MOV4hrjsGG5BVN5sSOQROs4wBbLJtWc0bSSO+9Qk490GEW1C4mKieSVKP0X+l6ef++M3z9OVg+gTkRyqgB8kkSEcl0q/O3aIWSVwm9Vz3jcWEH2+vH05MRk/ZIy2pz55+nzaoFk976tNIiKdW/hBrdxDh6Y541xLtJHCbZpl10EcOQbl0Df+iV3sT2XML0p/MRo72lTfp42e5YwTEbs7h57tpnbR+9HNn5kEeuy4c/RpqX45dNcujaCW1FvoZOhaH0b2TAoNYylJZhoSieMpHqhOhzfdRAgh8zPglFyDGDxH0NRaQppZ9VMSmlNmmsNS6nhG0vxFxYfMcONeIizfKuCPH/0zt+wJan/KybGHacUHkXaO5an+k20/QF46qedLPONpTh8siZVrwDQiDbZHKARMQWhOXi86j0gDIZRAl+gc0HPeukxpiO3VtVpS19CPAz4UVUpvqhJpcI0g8rwYXyZGm2Ks61Y6D0BC5gnhKOs56YZpOh/n1sxeDF6kW0hOnE9lZl0vzBcoOklfSEryGiKMpRWZHqLOy1HyzJ9iTEeJ1uXGnnGU+Dl2ANGIpBMkMde2Y4RE8ggr7AiRUpBrUKBNVTiu+/0iFDSnY+wI1EgOX3IGG4HHDj6ixRThsURLcxaBGqGXiR3955aE//grGmU6n8CP0q6WO4sMC0EiBq6FQ03BL4whnF+dloDZr8sNhrnHzKSY5umYHA4z5cUgEZeqT9SFxGVfYx5S8GPPe7OVfI1EbuCW/r2TzHvDlJ5m4q+u+zV7bEPkyq7x/1LtSECUs4ZPsis78tEuyvIktUApau6Xkf9tPU5z7+06cuYoMRHdyJ5j8zvdXDBrzTpzxxBBhVYpV5hIqJ80hgVHH0q44o7Mn2OasFYQoail3MixYIppZ4yiSj+0GCFHWtYA+G09Rjge7Py3VbHCoaVIWZj2nUD2xfedxUtIOX966t1W13PMO2GW9brdb4ovt3ewmgohlGM7+/Jhf0SI5f8BQXCSD/sl0kCKcvRqWuV+DEyPTg+DCCHaoXsmoTjwKak6Wq92hEPBTSVTZtoMoiEZcqWJxjUfjka6aD/wpJDSazeLGK2yHCaRLpr/rmPzRPpvTn6IoHFFRiQAAAAASUVORK5CYII=",te=e=>(xe("data-v-a2b8af59"),e=e(),we(),e),Wa={class:"container"},ja={key:0,class:"tab-container"},Xa={class:"video-container"},qa={class:"basic-flex"},Ka={class:"controls-container"},Qa=te(()=>o("i",{class:"center icon-caret-left-md"},null,-1)),Ja=te(()=>o("i",{class:"center icon-caret-right-md"},null,-1)),Za={key:1},en={class:"chat-container"},tn=te(()=>o("div",{class:"chat-header"},[o("h3",null,"Chat")],-1)),an={class:"chat-body"},nn={class:"basic-flex"},sn={class:"right-column"},ln={class:"center user-container"},on=te(()=>o("i",{class:"icon-users users"},null,-1)),cn=te(()=>o("i",{class:"center icon-cog-gear"},null,-1)),un=te(()=>o("h3",null,"Settings",-1)),dn=te(()=>o("i",{class:"center icon-chat"},null,-1)),rn=te(()=>o("i",{class:"center icon-video"},null,-1)),oe=2,vn=pe({__name:"InCallLandscape",setup(e){const t=Ce(),d=ke();let i=x([]);const I=x(""),v=x(1),g=t.state.localMedia;let l=null,r=null,m=x({});const f=x("");let y=x([]);const h=x(1),k=O(()=>t.state.pinLocal||h.value===1),z=O(()=>t.state.pinLocal?v.value-1:Math.ceil(v.value/oe));function H(){h.value*oe-1<v.value&&(h.value++,R())}function $(){h.value>1&&(h.value--,R())}function R(){let c=new Array;if(t.state.pinLocal||h.value===1)for(let n in m.value){let a=m.value[n];a.index===h.value&&c.push(a)}else for(let n in m.value){let a=m.value[n];(a.index===h.value*oe-oe||a.index===h.value*oe-1)&&c.push(a)}t.commit("setVideoList",c)}function L(){for(let c in m.value){const n=m.value[c].connection;(n.getState()!==C.ConnectionState.Closed.valueOf()||n.getState()!==C.ConnectionState.Closing)&&n.close(),delete m.value[c]}F(),d.push("/")}function P(){if(f.value.length===0)return;let c=new Date;var n={from:t.state.displayName,timestamp:new Date().getTime(),timestampHourFormat:c.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),timestampDateFormat:c.toLocaleString(),text:f.value};l&&l.sendMessage(JSON.stringify(n)),f.value=""}Ae(async()=>{await V(),t.commit("setLocalMedia",g),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",g.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",g.getAudioSourceInput().getId()),t.commit("setVideoMuted",g.getVideoMuted()),t.commit("setAudioMuted",g.getAudioMuted()),l&&l.addOnMessage(function(c,n){var a=JSON.parse(n);console.log(n),y.value.push({user:a.from,message:a.text})})});async function V(){const c=new C.Promise;r=new C.Client(Z.gatewayUrl,Z.applicationId),r.setUserAlias(t.state.displayName);const n=C.Token.generateClientRegisterToken(Z.applicationId,r.getUserId(),r.getDeviceId(),r.getId(),[new C.ChannelClaim(t.state.channelId)],Z.sharedSecret);return r.register(n).then(a=>{_(a),c.resolve(null)}).fail(a=>{C.Log.error("Failed to register with Gateway."),c.reject(a)}),c}function _(c){l=c[0];const n=E(t.state.localMedia);t.commit("setUpstreamConnection",n),l&&l.addOnRemoteUpstreamConnectionOpen(a=>b(a,l))}function b(c,n){const a=new C.RemoteMedia,D=new C.AudioStream(a),Y=new C.VideoStream(a);if(n){const T=n.createSfuDownstreamConnection(c,D,Y);return v.value===1&&t.commit("setVideoList",[{connection:T,media:a,index:v.value,displayName:c.getUserAlias()}]),m.value[T.getId()]={connection:T,media:a,index:v.value++,displayName:c.getUserAlias()},i.value.length===0&&a.getAudioSinkOutputs().then(function(B){i.value=B.map(j=>(j.getId()==="default"&&(I.value=j.getId()),{name:j.getName(),id:j.getId()}))}).fail(function(B){console.error(B)}),T.addOnStateChange(B=>{B.getRemoteClosed()&&(delete m.value[T.getId()],a.destroy(),v.value--)}),T.open(),T}}function E(c){const n=new C.AudioStream(c),a=new C.VideoStream(c);if(!l)return;const D=l.createSfuUpstreamConnection(n,a);return D.addOnStateChange(Y=>{C.Log.debug(`Upstream connection is ${new C.ConnectionStateWrapper(Y.getState()).toString()}.`)}),D.open(),D}function F(){if(r)return r.unregister().fail(()=>C.Log.error("Unregistration failed."))}const W=x("GALLERY");function N(c){W.value=c}return(c,n)=>(w(),U("div",Wa,[o("div",null,[W.value=="GALLERY"?(w(),U("div",ja,[o("div",Xa,[o("div",null,[u(t).state.localMedia&&k.value?(w(),K(re,{key:0,"ask-height":"265px","ask-width":"280px","local-video":u(t).state.localMedia,userName:"Me"},null,8,["local-video"])):se("",!0)]),o("div",qa,[u(t).state.videoList?(w(!0),U(ce,{key:0},ue(u(t).state.videoList,a=>(w(),K(re,{remoteVideo:a.media,index:a.index,userName:a.displayName,connection:a.connection,"ask-height":"265px","ask-width":"280px",maxIndex:oe},null,8,["remoteVideo","index","userName","connection"]))),256)):se("",!0)])]),o("div",Ka,[s(M,{class:G(["margin align-left",h.value===1?"inactive-button":"active-button"]),icon:"",onClick:$},{default:p(()=>[Qa]),_:1},8,["class"]),s(M,{class:"margin active-button",icon:"",onClick:n[0]||(n[0]=a=>u(t).commit("toggleLocalVideoMute"))},{default:p(()=>[o("i",{class:G(["center",u(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1}),s(M,{class:"margin active-button",icon:"",onClick:n[1]||(n[1]=a=>u(t).commit("toggleLocalAudioMute"))},{default:p(()=>[o("i",{class:G(["center",u(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1}),s(M,{class:G(["margin align-right",h.value===z.value?"inactive-button":"active-button"]),icon:"",onClick:H},{default:p(()=>[Ja]),_:1},8,["class"])])])):(w(),U("div",Za,[o("div",en,[tn,o("div",an,[(w(!0),U(ce,null,ue(u(y),a=>(w(),U("div",null,[o("div",{class:G(["chat-message",a.user===u(t).state.displayName?"my-chat":"other-chat"])},Q(a.user)+": "+Q(a.message),3)]))),256))]),o("div",nn,[s(Me,{label:"Chat Message",clearable:"",class:"chat-input","hide-details":"auto",modelValue:f.value,"onUpdate:modelValue":n[2]||(n[2]=a=>f.value=a)},null,8,["modelValue"]),s(M,{class:"chat-button",onClick:P},{default:p(()=>[q("Send")]),_:1})])])]))]),o("div",sn,[s(_e,{src:Ya,class:"logo"}),o("span",ln,[on,q(" "+Q(v.value),1)]),s(Xe,{"close-on-content-click":!1,location:"left"},{activator:p(({props:a})=>[s(M,ge({class:"margin center icon"},a,{icon:"",flat:""}),{default:p(()=>[cn]),_:2},1040)]),default:p(()=>[s(Ke,{class:"settings-menu"},{default:p(()=>[s(je,null,{default:p(()=>[s(ee,null,{default:p(()=>[un]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Camera",class:"margin input","hide-details":"auto",items:u(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeVideoDevice,"onUpdate:modelValue":[n[3]||(n[3]=a=>u(t).state.activeVideoDevice=a),n[4]||(n[4]=a=>u(t).commit("changeCamera"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Microphone",class:"margin input","hide-details":"auto",items:u(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeAudioDevice,"onUpdate:modelValue":[n[5]||(n[5]=a=>u(t).state.activeAudioDevice=a),n[6]||(n[6]=a=>u(t).commit("changeMicrophone"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Speaker",class:"margin input","hide-details":"auto"})]),_:1})]),_:1})]),_:1})]),_:1}),s(M,{icon:"",class:"center icon",flat:"",onClick:n[7]||(n[7]=a=>N("CHAT"))},{default:p(()=>[dn]),_:1}),s(M,{icon:"",class:"center icon",flat:"",onClick:n[8]||(n[8]=a=>N("GALLERY"))},{default:p(()=>[rn]),_:1}),s(M,{class:"center leave-button",onClick:L},{default:p(()=>[q("Leave")]),_:1})])]))}});const mn=Le(vn,[["__scopeId","data-v-a2b8af59"]]),hn=pe({__name:"InCall",setup(e){const{mobile:t}=Fe(),d=x(t&&window.innerHeight>window.innerWidth);return(i,I)=>u(t)?d.value?(w(),K(Fa,{key:1})):(w(),K(mn,{key:2})):(w(),K(la,{key:0}))}});export{hn as default};
