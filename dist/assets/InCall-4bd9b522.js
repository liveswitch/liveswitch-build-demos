import{d as pe,e as Ce,f as ke,i as et,r as I,w as Ve,o as Ae,j as x,k as O,l as o,b as s,t as q,C as Q,s as p,q as u,B as K,D as se,F as ce,E as ue,n as E,G as tt,v as at,x as xe,y as we,a as ve,m as Se,H as Ge,u as me,p as he,I as de,J as Ie,K as nt,L as st,M as $,N as it,O as lt,P as ot,Q as ne,R as ge,S as ct,A as Fe,T as Oe,U as ut,V as dt,W as rt,X as vt,Y as ae,Z as mt,z as C,_ as Z}from"./index-aefae0e8.js";import{_ as Ye,V as _e,e as M,a as re,d as J,b as Me,g as Le,h as Te,i as Re,j as Ue,k as ye,l as ft,n as gt,o as ht,p as pt,q as St,r as _t,s as yt,t as bt,u as Ct,R as kt,v as Vt,w as At,x as je,y as xt,z as wt,A as It,B as Mt,C as Lt,D as Tt,E as Rt,L as Pt,F as Dt,G as $t,H as Ot,I as Ut,J as zt,K as Nt,M as Bt,N as ze,O as Ne,P as Ht,Q as We,S as ee,T as Xe}from"./_plugin-vue_export-helper-2d728fc7.js";const qe=e=>(xe("data-v-4b618ad0"),e=e(),we(),e),Et={class:"container"},Gt={class:"left-column"},Ft={class:"flex-center"},Yt={class:"row-spread"},jt={class:"user-counter"},Wt=qe(()=>o("i",{class:"icon-users users"},null,-1)),Xt={class:"video-grid"},qt={class:"right-column"},Kt={class:"settings-menu"},Qt={class:"row"},Jt={class:"row"},Zt={class:"row"},ea={class:"chat-container"},ta=qe(()=>o("div",{class:"chat-header"},[o("h2",{class:"margin"},"Chat")],-1)),aa={class:"chat-body"},na={class:"chat-footer"},sa=pe({__name:"InCall",setup(e){const t=Ce(),d=ke(),l=et("liveSwitch");let w=null,r=null;const g=t.state.localMedia;let i=I({});const v=I(1);let m=I("100%");const f=I("");let V=I([]);Ve(v,function(){const b=Math.ceil(Math.sqrt(v.value)),h=100/b;m.value="calc("+h+"% - "+b*5+"px)"});async function S(){await l.disconnectFromMeeting(i.value,w,g),g.destroy(),t.commit("resetStore"),d.push("/")}async function k(b){const h=Object.keys(i.value)[0],y=i.value[h],G=await l.getAudioSink(b,y);l.updateSpeaker(i.value,G)}function U(b){i.value[b.getId()].remoteMedia.destroy(),delete i.value[b.getId()],v.value--}function z(){f.value.length!==0&&(l.sendChat(r,t.state.displayName,f.value),f.value="")}function D(b,h){let y=b.getRemoteConnectionInfo().getUserAlias();i.value[b.getId()]={connection:b,remoteMedia:h,index:v.value++,displayName:y},L(h),l.createDownStreamCloseHandler(b,U)}function R(b){var h=JSON.parse(b);V.value.push({user:h.from,message:h.text})}function L(b){t.state.speakerList.length===0&&t.commit("populateSpeakerList",b)}return Ae(async()=>{w=await l.registerClient(t.state.displayName,t.state.channelId),r=await l.getChannel(w),l.openSfuUpstreamConnection(t.state.localMedia,r),l.createDownStreamOpenHandler(r,D),t.commit("setLocalMedia",g),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",g.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",g.getAudioSourceInput().getId()),t.commit("setVideoMuted",g.getVideoMuted()),t.commit("setAudioMuted",g.getAudioMuted()),l.addIncomingChatHandler(r,R)}),(b,h)=>(x(),O("div",Et,[o("div",Gt,[o("div",Ft,[s(_e,{src:Ye,class:"logo"})]),o("div",Yt,[o("div",jt,[Wt,q(" "+Q(v.value),1)]),s(M,{class:"leave-button",onClick:S},{default:p(()=>[q("Leave Call")]),_:1})]),o("div",Xt,[u(t).state.localMedia?(x(),K(re,{key:0,class:"video","local-video":u(t).state.localMedia,userName:"Me",askHeight:u(m),askWidth:u(m)},null,8,["local-video","askHeight","askWidth"])):se("",!0),u(i)?(x(!0),O(ce,{key:1},ue(u(i),y=>(x(),K(re,{class:"video",remoteVideo:y.remoteMedia,index:y.index,userName:y.displayName,connection:y.connection,askHeight:u(m),askWidth:u(m)},null,8,["remoteVideo","index","userName","connection","askHeight","askWidth"]))),256)):se("",!0)])]),o("div",qt,[o("div",Kt,[o("div",Qt,[s(J,{label:"Camera",class:"margin input","hide-details":"auto",items:u(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeVideoDevice,"onUpdate:modelValue":[h[0]||(h[0]=y=>u(t).state.activeVideoDevice=y),h[1]||(h[1]=y=>u(t).commit("changeCamera"))]},null,8,["items","modelValue"]),s(M,{class:"margin button",icon:"",onClick:h[2]||(h[2]=y=>u(t).commit("toggleLocalVideoMute"))},{default:p(()=>[o("i",{class:E(["center",u(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1})]),o("div",Jt,[s(J,{label:"Microphone",class:"margin input","hide-details":"auto",items:u(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeAudioDevice,"onUpdate:modelValue":[h[3]||(h[3]=y=>u(t).state.activeAudioDevice=y),h[4]||(h[4]=y=>u(t).commit("changeMicrophone"))]},null,8,["items","modelValue"]),s(M,{class:"margin button",icon:"",onClick:h[5]||(h[5]=y=>u(t).commit("toggleLocalAudioMute"))},{default:p(()=>[o("i",{class:E(["center",u(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1})]),o("div",Zt,[u(t).state.speakerList.length>0?(x(),K(J,{key:0,label:"Speaker",class:"margin input","hide-details":"auto",items:u(t).state.speakerList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeSpeakerDevice,"onUpdate:modelValue":[h[6]||(h[6]=y=>u(t).state.activeSpeakerDevice=y),k]},null,8,["items","modelValue"])):se("",!0)])]),o("div",ea,[ta,o("div",aa,[(x(!0),O(ce,null,ue(u(V),y=>(x(),O("div",null,[o("div",{class:E(["chat-message",y.user===u(t).state.displayName?"my-chat":"other-chat"])},Q(y.user)+": "+Q(y.message),3)]))),256))]),o("div",na,[s(Me,{label:"Chat Message",clearable:"",class:"margin chat-input","hide-details":"auto",modelValue:f.value,"onUpdate:modelValue":h[7]||(h[7]=y=>f.value=y),onKeydown:tt(at(z,["prevent"]),["enter"])},null,8,["modelValue","onKeydown"]),s(M,{class:"chat-button",onClick:z},{default:p(()=>[q(" Send ")]),_:1})])])])]))}});const ia=Le(sa,[["__scopeId","data-v-4b618ad0"]]);const la=ve()({name:"VCardActions",props:Se(),setup(e,t){let{slots:d}=t;return Ge({VBtn:{variant:"text"}}),me(()=>{var l;return s("div",{class:["v-card-actions",e.class],style:e.style},[(l=d.default)==null?void 0:l.call(d)])}),{}}}),oa=Te("v-card-subtitle"),ca=Te("v-card-title"),ua=he({appendAvatar:String,appendIcon:de,prependAvatar:String,prependIcon:de,subtitle:String,title:String,...Se(),...Re()},"VCardItem"),da=ve()({name:"VCardItem",props:ua(),setup(e,t){let{slots:d}=t;return me(()=>{var m;const l=!!(e.prependAvatar||e.prependIcon),w=!!(l||d.prepend),r=!!(e.appendAvatar||e.appendIcon),g=!!(r||d.append),i=!!(e.title||d.title),v=!!(e.subtitle||d.subtitle);return s("div",{class:["v-card-item",e.class],style:e.style},[w&&s("div",{key:"prepend",class:"v-card-item__prepend"},[d.prepend?s(ye,{key:"prepend-defaults",disabled:!l,defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar}}},d.prepend):l&&s(Ue,{key:"prepend-avatar",density:e.density,icon:e.prependIcon,image:e.prependAvatar},null)]),s("div",{class:"v-card-item__content"},[i&&s(ca,{key:"title"},{default:()=>{var f;return[((f=d.title)==null?void 0:f.call(d))??e.title]}}),v&&s(oa,{key:"subtitle"},{default:()=>{var f;return[((f=d.subtitle)==null?void 0:f.call(d))??e.subtitle]}}),(m=d.default)==null?void 0:m.call(d)]),g&&s("div",{key:"append",class:"v-card-item__append"},[d.append?s(ye,{key:"append-defaults",disabled:!r,defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar}}},d.append):r&&s(Ue,{key:"append-avatar",density:e.density,icon:e.appendIcon,image:e.appendAvatar},null)])])}),{}}}),ra=Te("v-card-text"),va=he({appendAvatar:String,appendIcon:de,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:de,ripple:{type:[Boolean,Object],default:!0},subtitle:String,text:String,title:String,...ft(),...Se(),...Re(),...gt(),...ht(),...pt(),...St(),..._t(),...yt(),...bt(),...Ie(),...nt(),...Ct({variant:"elevated"})},"VCard"),Ke=ve()({name:"VCard",directives:{Ripple:kt},props:va(),setup(e,t){let{attrs:d,slots:l}=t;const{themeClasses:w}=st(e),{borderClasses:r}=Vt(e),{colorClasses:g,colorStyles:i,variantClasses:v}=At(e),{densityClasses:m}=je(e),{dimensionStyles:f}=xt(e),{elevationClasses:V}=wt(e),{loaderClasses:S}=It(e),{locationStyles:k}=Mt(e),{positionClasses:U}=Lt(e),{roundedClasses:z}=Tt(e),D=Rt(e,d),R=$(()=>e.link!==!1&&D.isLink.value),L=$(()=>!e.disabled&&e.link!==!1&&(e.link||D.isClickable.value));return me(()=>{const b=R.value?"a":e.tag,h=!!(l.title||e.title),y=!!(l.subtitle||e.subtitle),G=h||y,H=!!(l.append||e.appendAvatar||e.appendIcon),F=!!(l.prepend||e.prependAvatar||e.prependIcon),j=!!(l.image||e.image),N=G||F||H,c=!!(l.text||e.text);return it(s(b,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":L.value},w.value,r.value,g.value,m.value,V.value,S.value,U.value,z.value,v.value,e.class],style:[i.value,f.value,k.value,e.style],href:D.href.value,onClick:L.value&&D.navigate,tabindex:e.disabled?-1:void 0},{default:()=>{var n;return[j&&s("div",{key:"image",class:"v-card__image"},[l.image?s(ye,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},l.image):s(_e,{key:"image-img",cover:!0,src:e.image},null)]),s(Pt,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:l.loader}),N&&s(da,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:l.item,prepend:l.prepend,title:l.title,subtitle:l.subtitle,append:l.append}),c&&s(ra,{key:"text"},{default:()=>{var a;return[((a=l.text)==null?void 0:a.call(l))??e.text]}}),(n=l.default)==null?void 0:n.call(l),l.actions&&s(la,null,{default:l.actions}),Dt(L.value,"v-card")]}}),[[lt("ripple"),L.value&&e.ripple]])}),{}}});const Qe=Symbol.for("vuetify:v-tabs"),ma=he({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...ot($t({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),be=ve()({name:"VTab",props:ma(),setup(e,t){let{slots:d,attrs:l}=t;const{textColorClasses:w,textColorStyles:r}=Ot(e,"sliderColor"),g=$(()=>e.direction==="horizontal"),i=ne(!1),v=I(),m=I();function f(V){var k,U;let{value:S}=V;if(i.value=S,S){const z=(U=(k=v.value)==null?void 0:k.$el.parentElement)==null?void 0:U.querySelector(".v-tab--selected .v-tab__slider"),D=m.value;if(!z||!D)return;const R=getComputedStyle(z).color,L=z.getBoundingClientRect(),b=D.getBoundingClientRect(),h=g.value?"x":"y",y=g.value?"X":"Y",G=g.value?"right":"bottom",H=g.value?"width":"height",F=L[h],j=b[h],N=F>j?L[G]-b[G]:L[h]-b[h],c=Math.sign(N)>0?g.value?"right":"bottom":Math.sign(N)<0?g.value?"left":"top":"center",a=(Math.abs(N)+(Math.sign(N)<0?L[H]:b[H]))/Math.max(L[H],b[H])||0,P=L[H]/b[H]||0,Y=1.5;Ut(D,{backgroundColor:[R,"currentcolor"],transform:[`translate${y}(${N}px) scale${y}(${P})`,`translate${y}(${N/Y}px) scale${y}(${(a-1)/Y+1})`,"none"],transformOrigin:Array(3).fill(c)},{duration:225,easing:zt})}}return me(()=>{const[V]=M.filterProps(e);return s(M,ge({symbol:Qe,ref:v,class:["v-tab",e.class],style:e.style,tabindex:i.value?0:-1,role:"tab","aria-selected":String(i.value),active:!1},V,l,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":f}),{default:()=>{var S;return[((S=d.default)==null?void 0:S.call(d))??e.text,!e.hideSlider&&s("div",{ref:m,class:["v-tab__slider",w.value],style:r.value},null)]}})}),{}}});function Be(e){const d=Math.abs(e);return Math.sign(e)*(d/((1/.501-2)*(1-d)+1))}function He(e){let{selectedElement:t,containerSize:d,contentSize:l,isRtl:w,currentScrollOffset:r,isHorizontal:g}=e;const i=g?t.clientWidth:t.clientHeight,v=g?t.offsetLeft:t.offsetTop,m=w&&g?l-v-i:v,f=d+r,V=i+m,S=i*.4;return m<=r?r=Math.max(m-S,0):f<=V&&(r=Math.min(r-(f-V-S),l-d)),r}function fa(e){let{selectedElement:t,containerSize:d,contentSize:l,isRtl:w,isHorizontal:r}=e;const g=r?t.clientWidth:t.clientHeight,i=r?t.offsetLeft:t.offsetTop,v=w&&r?l-i-g/2-d/2:i+g/2-d/2;return Math.min(l-d,Math.max(0,v))}const ga=Symbol.for("vuetify:v-slide-group"),Je=he({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:ga},nextIcon:{type:de,default:"$next"},prevIcon:{type:de,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...Se(),...Ie(),...Nt({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),Ee=ve()({name:"VSlideGroup",props:Je(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:d}=t;const{isRtl:l}=ct(),{mobile:w}=Fe(),r=Bt(e,e.symbol),g=ne(!1),i=ne(0),v=ne(0),m=ne(0),f=$(()=>e.direction==="horizontal"),{resizeRef:V,contentRect:S}=Oe(),{resizeRef:k,contentRect:U}=Oe(),z=$(()=>r.selected.value.length?r.items.value.findIndex(_=>_.id===r.selected.value[0]):-1),D=$(()=>r.selected.value.length?r.items.value.findIndex(_=>_.id===r.selected.value[r.selected.value.length-1]):-1);if(ut){let _=-1;Ve(()=>[r.selected.value,S.value,U.value,f.value],()=>{cancelAnimationFrame(_),_=requestAnimationFrame(()=>{if(S.value&&U.value){const A=f.value?"width":"height";v.value=S.value[A],m.value=U.value[A],g.value=v.value+1<m.value}if(z.value>=0&&k.value){const A=k.value.children[D.value];z.value===0||!g.value?i.value=0:e.centerActive?i.value=fa({selectedElement:A,containerSize:v.value,contentSize:m.value,isRtl:l.value,isHorizontal:f.value}):g.value&&(i.value=He({selectedElement:A,containerSize:v.value,contentSize:m.value,isRtl:l.value,currentScrollOffset:i.value,isHorizontal:f.value}))}})})}const R=ne(!1);let L=0,b=0;function h(_){const A=f.value?"clientX":"clientY";b=(l.value&&f.value?-1:1)*i.value,L=_.touches[0][A],R.value=!0}function y(_){if(!g.value)return;const A=f.value?"clientX":"clientY",X=l.value&&f.value?-1:1;i.value=X*(b+L-_.touches[0][A])}function G(_){const A=m.value-v.value;i.value<0||!g.value?i.value=0:i.value>=A&&(i.value=A),R.value=!1}function H(){V.value&&(V.value[f.value?"scrollLeft":"scrollTop"]=0)}const F=ne(!1);function j(_){if(F.value=!0,!(!g.value||!k.value)){for(const A of _.composedPath())for(const X of k.value.children)if(X===A){i.value=He({selectedElement:X,containerSize:v.value,contentSize:m.value,isRtl:l.value,currentScrollOffset:i.value,isHorizontal:f.value});return}}}function N(_){F.value=!1}function c(_){var A;!F.value&&!(_.relatedTarget&&((A=k.value)!=null&&A.contains(_.relatedTarget)))&&a()}function n(_){k.value&&(f.value?_.key==="ArrowRight"?a(l.value?"prev":"next"):_.key==="ArrowLeft"&&a(l.value?"next":"prev"):_.key==="ArrowDown"?a("next"):_.key==="ArrowUp"&&a("prev"),_.key==="Home"?a("first"):_.key==="End"&&a("last"))}function a(_){var A,X,Pe,De,$e;if(k.value)if(!_)(A=dt(k.value)[0])==null||A.focus();else if(_==="next"){const ie=(X=k.value.querySelector(":focus"))==null?void 0:X.nextElementSibling;ie?ie.focus():a("first")}else if(_==="prev"){const ie=(Pe=k.value.querySelector(":focus"))==null?void 0:Pe.previousElementSibling;ie?ie.focus():a("last")}else _==="first"?(De=k.value.firstElementChild)==null||De.focus():_==="last"&&(($e=k.value.lastElementChild)==null||$e.focus())}function P(_){const A=i.value+(_==="prev"?-1:1)*v.value;i.value=rt(A,0,m.value-v.value)}const Y=$(()=>{let _=i.value>m.value-v.value?-(m.value-v.value)+Be(m.value-v.value-i.value):-i.value;i.value<=0&&(_=Be(-i.value));const A=l.value&&f.value?-1:1;return{transform:`translate${f.value?"X":"Y"}(${A*_}px)`,transition:R.value?"none":"",willChange:R.value?"transform":""}}),T=$(()=>({next:r.next,prev:r.prev,select:r.select,isSelected:r.isSelected})),B=$(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!w.value;case!0:return g.value||Math.abs(i.value)>0;case"mobile":return w.value||g.value||Math.abs(i.value)>0;default:return!w.value&&(g.value||Math.abs(i.value)>0)}}),W=$(()=>Math.abs(i.value)>0),Ze=$(()=>m.value>Math.abs(i.value)+v.value);return me(()=>s(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!f.value,"v-slide-group--has-affixes":B.value,"v-slide-group--is-overflowing":g.value},e.class],style:e.style,tabindex:F.value||r.selected.value.length?-1:0,onFocus:c},{default:()=>{var _,A,X;return[B.value&&s("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!W.value}],onClick:()=>P("prev")},[((_=d.prev)==null?void 0:_.call(d,T.value))??s(ze,null,{default:()=>[s(Ne,{icon:l.value?e.nextIcon:e.prevIcon},null)]})]),s("div",{key:"container",ref:V,class:"v-slide-group__container",onScroll:H},[s("div",{ref:k,class:"v-slide-group__content",style:Y.value,onTouchstartPassive:h,onTouchmovePassive:y,onTouchendPassive:G,onFocusin:j,onFocusout:N,onKeydown:n},[(A=d.default)==null?void 0:A.call(d,T.value)])]),B.value&&s("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!Ze.value}],onClick:()=>P("next")},[((X=d.next)==null?void 0:X.call(d,T.value))??s(ze,null,{default:()=>[s(Ne,{icon:l.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:r.selected,scrollTo:P,scrollOffset:i,focus:a}}});function ha(e){return e?e.map(t=>typeof t=="string"?{title:t,value:t}:t):[]}const pa=he({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Je({mandatory:"force"}),...Re(),...Ie()},"VTabs"),Sa=ve()({name:"VTabs",props:pa(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:d}=t;const l=vt(e,"modelValue"),w=$(()=>ha(e.items)),{densityClasses:r}=je(e),{backgroundColorClasses:g,backgroundColorStyles:i}=Ht(ae(e,"bgColor"));return Ge({VTab:{color:ae(e,"color"),direction:ae(e,"direction"),stacked:ae(e,"stacked"),fixed:ae(e,"fixedTabs"),sliderColor:ae(e,"sliderColor"),hideSlider:ae(e,"hideSlider")}}),me(()=>{const[v]=Ee.filterProps(e);return s(Ee,ge(v,{modelValue:l.value,"onUpdate:modelValue":m=>l.value=m,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},r.value,g.value,e.class],style:[{"--v-tabs-height":mt(e.height)},i.value,e.style],role:"tablist",symbol:Qe}),{default:()=>[d.default?d.default():w.value.map(m=>s(be,ge(m,{key:m.title}),null))]})}),{}}}),fe=e=>(xe("data-v-e2c6dad3"),e=e(),we(),e),_a={class:"container"},ya={class:"column"},ba={class:"margin spread"},Ca={class:"row"},ka=fe(()=>o("i",{class:"center icon-cog-gear"},null,-1)),Va=fe(()=>o("h3",null,"Settings",-1)),Aa={class:"users-container"},xa=fe(()=>o("i",{class:"icon-users users"},null,-1)),wa={class:"button-wrapper"},Ia={class:"tab-container"},Ma={key:0},La={class:"basic-flex"},Ta={class:"even-spacing"},Ra={class:"video-container"},Pa={class:"video-container"},Da={class:"controls-container"},$a=fe(()=>o("i",{class:"center icon-caret-left-md"},null,-1)),Oa={class:"row-center"},Ua=fe(()=>o("i",{class:"center icon-caret-right-md"},null,-1)),za={key:1,class:"chat-container"},Na=fe(()=>o("div",{class:"chat-header"},[o("h3",null,"Chat")],-1)),Ba={class:"chat-body"},Ha={class:"chat-footer"},Ea={class:"tab-buttons"},le=2,Ga=pe({__name:"InCallPortrait",setup(e){const t=Ce(),d=ke(),l=$(()=>t.state.pinLocal||v.value===1),w=$(()=>{let c=1;return t.state.pinLocal?c=i.value-1:c=Math.ceil(i.value/le),c});Ve(t.state.pinLocal,R);let r=I([]);const g=I(""),i=I(1),v=I(1),m=t.state.localMedia;let f=null,V=null,S=I({});const k=I("");let U=I([]);function z(){v.value*le-1<i.value&&(v.value++,R())}function D(){v.value>1&&(v.value--,R())}function R(){let c=new Array;if(t.state.pinLocal||v.value===1)for(let n in S.value){let a=S.value[n];a.index===v.value&&c.push(a)}else for(let n in S.value){let a=S.value[n];(a.index===v.value*le-le||a.index===v.value*le-1)&&c.push(a)}t.commit("setVideoList",c)}function L(){for(let c in S.value){const n=S.value[c].connection;(n.getState()!==C.ConnectionState.Closed.valueOf()||n.getState()!==C.ConnectionState.Closing)&&n.close(),delete S.value[c]}F(),d.push("/")}function b(){if(k.value.length===0)return;let c=new Date;var n={from:t.state.displayName,timestamp:new Date().getTime(),timestampHourFormat:c.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),timestampDateFormat:c.toLocaleString(),text:k.value};f&&f.sendMessage(JSON.stringify(n)),k.value=""}Ae(async()=>{await h(),t.commit("setLocalMedia",m),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",m.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",m.getAudioSourceInput().getId()),t.commit("setVideoMuted",m.getVideoMuted()),t.commit("setAudioMuted",m.getAudioMuted()),f&&f.addOnMessage(function(c,n){var a=JSON.parse(n);console.log(n),U.value.push({user:a.from,message:a.text})})});async function h(){const c=new C.Promise;V=new C.Client(Z.gatewayUrl,Z.applicationId),V.setUserAlias(t.state.displayName);const n=C.Token.generateClientRegisterToken(Z.applicationId,V.getUserId(),V.getDeviceId(),V.getId(),[new C.ChannelClaim(t.state.channelId)],Z.sharedSecret);return V.register(n).then(a=>{y(a),c.resolve(null)}).fail(a=>{C.Log.error("Failed to register with Gateway."),c.reject(a)}),c}function y(c){f=c[0];const n=H(t.state.localMedia);t.commit("setUpstreamConnection",n),f&&f.addOnRemoteUpstreamConnectionOpen(a=>G(a,f))}function G(c,n){const a=new C.RemoteMedia,P=new C.AudioStream(a),Y=new C.VideoStream(a);if(n){const T=n.createSfuDownstreamConnection(c,P,Y);return i.value===1&&t.commit("setVideoList",[{connection:T,media:a,index:i.value,displayName:c.getUserAlias()}]),S.value[T.getId()]={connection:T,media:a,index:i.value++,displayName:c.getUserAlias()},r.value.length===0&&a.getAudioSinkOutputs().then(function(B){r.value=B.map(W=>(W.getId()==="default"&&(g.value=W.getId()),{name:W.getName(),id:W.getId()}))}).fail(function(B){console.error(B)}),T.addOnStateChange(B=>{B.getRemoteClosed()&&(delete S.value[T.getId()],a.destroy(),i.value--)}),T.open(),T}}function H(c){const n=new C.AudioStream(c),a=new C.VideoStream(c);if(!f)return;const P=f.createSfuUpstreamConnection(n,a);return P.addOnStateChange(Y=>{C.Log.debug(`Upstream connection is ${new C.ConnectionStateWrapper(Y.getState()).toString()}.`)}),P.open(),P}function F(){if(V)return V.unregister().fail(()=>C.Log.error("Unregistration failed."))}const j=I("GALLERY");function N(c){j.value=c.target.innerText}return(c,n)=>(x(),O("div",_a,[o("div",ya,[s(_e,{src:Ye,class:"logo"}),o("div",ba,[o("div",Ca,[s(Xe,{"close-on-content-click":!1,location:"bottom"},{activator:p(({props:a})=>[s(M,ge(a,{icon:"",class:"icon",flat:""}),{default:p(()=>[ka]),_:2},1040)]),default:p(()=>[s(Ke,{class:"settings-menu"},{default:p(()=>[s(We,null,{default:p(()=>[s(ee,null,{default:p(()=>[Va]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Camera",class:"margin input","hide-details":"auto",items:u(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeVideoDevice,"onUpdate:modelValue":[n[0]||(n[0]=a=>u(t).state.activeVideoDevice=a),n[1]||(n[1]=a=>u(t).commit("changeCamera"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Microphone",class:"margin input","hide-details":"auto",items:u(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeAudioDevice,"onUpdate:modelValue":[n[2]||(n[2]=a=>u(t).state.activeAudioDevice=a),n[3]||(n[3]=a=>u(t).commit("changeMicrophone"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Speaker",class:"margin input","hide-details":"auto"})]),_:1})]),_:1})]),_:1})]),_:1}),o("div",Aa,[xa,q(" "+Q(i.value),1)])]),o("div",wa,[s(M,{class:"leave-button",onClick:L},{default:p(()=>[q("Leave")]),_:1})])]),o("div",Ia,[j.value==="GALLERY"?(x(),O("div",Ma,[o("div",La,[o("div",Ta,[o("div",Ra,[u(t).state.localMedia&&l.value?(x(),K(re,{key:0,"ask-height":"240px","ask-width":"320px","local-video":u(t).state.localMedia,userName:"Me"},null,8,["local-video"])):se("",!0)]),o("div",Pa,[u(t).state.videoList?(x(!0),O(ce,{key:0},ue(u(t).state.videoList,a=>(x(),K(re,{remoteVideo:a.media,index:a.index,userName:a.displayName,connection:a.connection,"ask-height":"240px","ask-width":"320px",maxIndex:le},null,8,["remoteVideo","index","userName","connection"]))),256)):se("",!0)])])]),o("div",Da,[s(M,{class:E(["margin align-left",v.value===1?"inactive-button":"active-button"]),icon:"",onClick:D},{default:p(()=>[$a]),_:1},8,["class"]),o("div",Oa,[s(M,{class:"margin active-button",icon:"",onClick:n[4]||(n[4]=a=>u(t).commit("toggleLocalVideoMute"))},{default:p(()=>[o("i",{class:E(["center",u(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1}),s(M,{class:"margin active-button",icon:"",onClick:n[5]||(n[5]=a=>u(t).commit("toggleLocalAudioMute"))},{default:p(()=>[o("i",{class:E(["center",u(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1})]),s(M,{class:E(["margin active-button align-right",v.value===w.value?"inactive-button":"active-button"]),icon:"",onClick:z},{default:p(()=>[Ua]),_:1},8,["class"])])])):(x(),O("div",za,[Na,o("div",Ba,[(x(!0),O(ce,null,ue(u(U),a=>(x(),O("div",null,[o("div",{class:E(["chat-message",a.user===u(t).state.displayName?"my-chat":"other-chat"])},Q(a.user)+": "+Q(a.message),3)]))),256))]),o("div",Ha,[s(Me,{label:"Chat Message",clearable:"",class:"margin chat-input","hide-details":"auto",modelValue:k.value,"onUpdate:modelValue":n[6]||(n[6]=a=>k.value=a)},null,8,["modelValue"]),s(M,{class:"chat-button",onClick:b},{default:p(()=>[q("Send")]),_:1})])]))]),o("div",Ea,[s(Sa,{"fixed-tabs":"","selected-class":"activeTab",class:"tabs",onClick:N},{default:p(()=>[s(be,{value:"gallery"},{default:p(()=>[q("Gallery")]),_:1}),s(be,{value:"chat"},{default:p(()=>[q("Chat")]),_:1})]),_:1})])])]))}});const Fa=Le(Ga,[["__scopeId","data-v-e2c6dad3"]]),Ya="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAzCAYAAADVY1sUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATLSURBVHgBzVrtcdw2EH3U+L/jCkKlgERxA6bVQKQKxLgB0S4goSqQ1EBySgGR3UDCVCC5gYgd+FwBjMclxY8jsCB5N3dvBpwTAQJ8u4vdxVIRDgGZ4fU7RLiAwZn9fVL9LXis2x1uosI1RYR9Q0j8zl9oX96Ff217ZwmVw479ERECx7b9DdFAKIx9619xHd11b+6HSEviH9tiTMcGmTAimaHE2Na2FVa1a8xFOIkb264g5pZCzK+LL7a9bszsBdwLcoJL9G13bR98hWWg8P6An8SVXSd/XjMzJPTGtqQz5lU9zyn/OBqdJjOxvT7YlqO/AUssQbuxE8+opw6JLj6P3EtqgY8QERL0DvHIg/NNSkCTuvT0k+k7x/3PjmdSXsY0kmPeBgwBteFzsaUvVoyAZvojf/SJiDYusAvoc9MTXXn6XQKIeRlqJMHukKsjDP7z9L709G0Q0QJTjPl4o/R/GovYNWhCP3me3SCipQhx4yUmITNn8AuBZvURfriE/JWXIZEQrzQlnWig7bv1MOV4hrjsGG5BVN5sSOQROs4wBbLJtWc0bSSO+9Qk490GEW1C4mKieSVKP0X+l6ef++M3z9OVg+gTkRyqgB8kkSEcl0q/O3aIWSVwm9Vz3jcWEH2+vH05MRk/ZIy2pz55+nzaoFk976tNIiKdW/hBrdxDh6Y541xLtJHCbZpl10EcOQbl0Df+iV3sT2XML0p/MRo72lTfp42e5YwTEbs7h57tpnbR+9HNn5kEeuy4c/RpqX45dNcujaCW1FvoZOhaH0b2TAoNYylJZhoSieMpHqhOhzfdRAgh8zPglFyDGDxH0NRaQppZ9VMSmlNmmsNS6nhG0vxFxYfMcONeIizfKuCPH/0zt+wJan/KybGHacUHkXaO5an+k20/QF46qedLPONpTh8siZVrwDQiDbZHKARMQWhOXi86j0gDIZRAl+gc0HPeukxpiO3VtVpS19CPAz4UVUpvqhJpcI0g8rwYXyZGm2Ks61Y6D0BC5gnhKOs56YZpOh/n1sxeDF6kW0hOnE9lZl0vzBcoOklfSEryGiKMpRWZHqLOy1HyzJ9iTEeJ1uXGnnGU+Dl2ANGIpBMkMde2Y4RE8ggr7AiRUpBrUKBNVTiu+/0iFDSnY+wI1EgOX3IGG4HHDj6ixRThsURLcxaBGqGXiR3955aE//grGmU6n8CP0q6WO4sMC0EiBq6FQ03BL4whnF+dloDZr8sNhrnHzKSY5umYHA4z5cUgEZeqT9SFxGVfYx5S8GPPe7OVfI1EbuCW/r2TzHvDlJ5m4q+u+zV7bEPkyq7x/1LtSECUs4ZPsis78tEuyvIktUApau6Xkf9tPU5z7+06cuYoMRHdyJ5j8zvdXDBrzTpzxxBBhVYpV5hIqJ80hgVHH0q44o7Mn2OasFYQoail3MixYIppZ4yiSj+0GCFHWtYA+G09Rjge7Py3VbHCoaVIWZj2nUD2xfedxUtIOX966t1W13PMO2GW9brdb4ovt3ewmgohlGM7+/Jhf0SI5f8BQXCSD/sl0kCKcvRqWuV+DEyPTg+DCCHaoXsmoTjwKak6Wq92hEPBTSVTZtoMoiEZcqWJxjUfjka6aD/wpJDSazeLGK2yHCaRLpr/rmPzRPpvTn6IoHFFRiQAAAAASUVORK5CYII=",te=e=>(xe("data-v-a2b8af59"),e=e(),we(),e),ja={class:"container"},Wa={key:0,class:"tab-container"},Xa={class:"video-container"},qa={class:"basic-flex"},Ka={class:"controls-container"},Qa=te(()=>o("i",{class:"center icon-caret-left-md"},null,-1)),Ja=te(()=>o("i",{class:"center icon-caret-right-md"},null,-1)),Za={key:1},en={class:"chat-container"},tn=te(()=>o("div",{class:"chat-header"},[o("h3",null,"Chat")],-1)),an={class:"chat-body"},nn={class:"basic-flex"},sn={class:"right-column"},ln={class:"center user-container"},on=te(()=>o("i",{class:"icon-users users"},null,-1)),cn=te(()=>o("i",{class:"center icon-cog-gear"},null,-1)),un=te(()=>o("h3",null,"Settings",-1)),dn=te(()=>o("i",{class:"center icon-chat"},null,-1)),rn=te(()=>o("i",{class:"center icon-video"},null,-1)),oe=2,vn=pe({__name:"InCallLandscape",setup(e){const t=Ce(),d=ke();let l=I([]);const w=I(""),r=I(1),g=t.state.localMedia;let i=null,v=null,m=I({});const f=I("");let V=I([]);const S=I(1),k=$(()=>t.state.pinLocal||S.value===1),U=$(()=>t.state.pinLocal?r.value-1:Math.ceil(r.value/oe));function z(){S.value*oe-1<r.value&&(S.value++,R())}function D(){S.value>1&&(S.value--,R())}function R(){let c=new Array;if(t.state.pinLocal||S.value===1)for(let n in m.value){let a=m.value[n];a.index===S.value&&c.push(a)}else for(let n in m.value){let a=m.value[n];(a.index===S.value*oe-oe||a.index===S.value*oe-1)&&c.push(a)}t.commit("setVideoList",c)}function L(){for(let c in m.value){const n=m.value[c].connection;(n.getState()!==C.ConnectionState.Closed.valueOf()||n.getState()!==C.ConnectionState.Closing)&&n.close(),delete m.value[c]}F(),d.push("/")}function b(){if(f.value.length===0)return;let c=new Date;var n={from:t.state.displayName,timestamp:new Date().getTime(),timestampHourFormat:c.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),timestampDateFormat:c.toLocaleString(),text:f.value};i&&i.sendMessage(JSON.stringify(n)),f.value=""}Ae(async()=>{await h(),t.commit("setLocalMedia",g),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",g.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",g.getAudioSourceInput().getId()),t.commit("setVideoMuted",g.getVideoMuted()),t.commit("setAudioMuted",g.getAudioMuted()),i&&i.addOnMessage(function(c,n){var a=JSON.parse(n);console.log(n),V.value.push({user:a.from,message:a.text})})});async function h(){const c=new C.Promise;v=new C.Client(Z.gatewayUrl,Z.applicationId),v.setUserAlias(t.state.displayName);const n=C.Token.generateClientRegisterToken(Z.applicationId,v.getUserId(),v.getDeviceId(),v.getId(),[new C.ChannelClaim(t.state.channelId)],Z.sharedSecret);return v.register(n).then(a=>{y(a),c.resolve(null)}).fail(a=>{C.Log.error("Failed to register with Gateway."),c.reject(a)}),c}function y(c){i=c[0];const n=H(t.state.localMedia);t.commit("setUpstreamConnection",n),i&&i.addOnRemoteUpstreamConnectionOpen(a=>G(a,i))}function G(c,n){const a=new C.RemoteMedia,P=new C.AudioStream(a),Y=new C.VideoStream(a);if(n){const T=n.createSfuDownstreamConnection(c,P,Y);return r.value===1&&t.commit("setVideoList",[{connection:T,media:a,index:r.value,displayName:c.getUserAlias()}]),m.value[T.getId()]={connection:T,media:a,index:r.value++,displayName:c.getUserAlias()},l.value.length===0&&a.getAudioSinkOutputs().then(function(B){l.value=B.map(W=>(W.getId()==="default"&&(w.value=W.getId()),{name:W.getName(),id:W.getId()}))}).fail(function(B){console.error(B)}),T.addOnStateChange(B=>{B.getRemoteClosed()&&(delete m.value[T.getId()],a.destroy(),r.value--)}),T.open(),T}}function H(c){const n=new C.AudioStream(c),a=new C.VideoStream(c);if(!i)return;const P=i.createSfuUpstreamConnection(n,a);return P.addOnStateChange(Y=>{C.Log.debug(`Upstream connection is ${new C.ConnectionStateWrapper(Y.getState()).toString()}.`)}),P.open(),P}function F(){if(v)return v.unregister().fail(()=>C.Log.error("Unregistration failed."))}const j=I("GALLERY");function N(c){j.value=c}return(c,n)=>(x(),O("div",ja,[o("div",null,[j.value=="GALLERY"?(x(),O("div",Wa,[o("div",Xa,[o("div",null,[u(t).state.localMedia&&k.value?(x(),K(re,{key:0,"ask-height":"265px","ask-width":"280px","local-video":u(t).state.localMedia,userName:"Me"},null,8,["local-video"])):se("",!0)]),o("div",qa,[u(t).state.videoList?(x(!0),O(ce,{key:0},ue(u(t).state.videoList,a=>(x(),K(re,{remoteVideo:a.media,index:a.index,userName:a.displayName,connection:a.connection,"ask-height":"265px","ask-width":"280px",maxIndex:oe},null,8,["remoteVideo","index","userName","connection"]))),256)):se("",!0)])]),o("div",Ka,[s(M,{class:E(["margin align-left",S.value===1?"inactive-button":"active-button"]),icon:"",onClick:D},{default:p(()=>[Qa]),_:1},8,["class"]),s(M,{class:"margin active-button",icon:"",onClick:n[0]||(n[0]=a=>u(t).commit("toggleLocalVideoMute"))},{default:p(()=>[o("i",{class:E(["center",u(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1}),s(M,{class:"margin active-button",icon:"",onClick:n[1]||(n[1]=a=>u(t).commit("toggleLocalAudioMute"))},{default:p(()=>[o("i",{class:E(["center",u(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1}),s(M,{class:E(["margin align-right",S.value===U.value?"inactive-button":"active-button"]),icon:"",onClick:z},{default:p(()=>[Ja]),_:1},8,["class"])])])):(x(),O("div",Za,[o("div",en,[tn,o("div",an,[(x(!0),O(ce,null,ue(u(V),a=>(x(),O("div",null,[o("div",{class:E(["chat-message",a.user===u(t).state.displayName?"my-chat":"other-chat"])},Q(a.user)+": "+Q(a.message),3)]))),256))]),o("div",nn,[s(Me,{label:"Chat Message",clearable:"",class:"chat-input","hide-details":"auto",modelValue:f.value,"onUpdate:modelValue":n[2]||(n[2]=a=>f.value=a)},null,8,["modelValue"]),s(M,{class:"chat-button",onClick:b},{default:p(()=>[q("Send")]),_:1})])])]))]),o("div",sn,[s(_e,{src:Ya,class:"logo"}),o("span",ln,[on,q(" "+Q(r.value),1)]),s(Xe,{"close-on-content-click":!1,location:"left"},{activator:p(({props:a})=>[s(M,ge({class:"margin center icon"},a,{icon:"",flat:""}),{default:p(()=>[cn]),_:2},1040)]),default:p(()=>[s(Ke,{class:"settings-menu"},{default:p(()=>[s(We,null,{default:p(()=>[s(ee,null,{default:p(()=>[un]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Camera",class:"margin input","hide-details":"auto",items:u(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeVideoDevice,"onUpdate:modelValue":[n[3]||(n[3]=a=>u(t).state.activeVideoDevice=a),n[4]||(n[4]=a=>u(t).commit("changeCamera"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Microphone",class:"margin input","hide-details":"auto",items:u(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:u(t).state.activeAudioDevice,"onUpdate:modelValue":[n[5]||(n[5]=a=>u(t).state.activeAudioDevice=a),n[6]||(n[6]=a=>u(t).commit("changeMicrophone"))]},null,8,["items","modelValue"])]),_:1}),s(ee,null,{default:p(()=>[s(J,{label:"Speaker",class:"margin input","hide-details":"auto"})]),_:1})]),_:1})]),_:1})]),_:1}),s(M,{icon:"",class:"center icon",flat:"",onClick:n[7]||(n[7]=a=>N("CHAT"))},{default:p(()=>[dn]),_:1}),s(M,{icon:"",class:"center icon",flat:"",onClick:n[8]||(n[8]=a=>N("GALLERY"))},{default:p(()=>[rn]),_:1}),s(M,{class:"center leave-button",onClick:L},{default:p(()=>[q("Leave")]),_:1})])]))}});const mn=Le(vn,[["__scopeId","data-v-a2b8af59"]]),hn=pe({__name:"InCall",setup(e){const{mobile:t}=Fe(),d=I(t&&window.innerHeight>window.innerWidth);return(l,w)=>u(t)?d.value?(x(),K(Fa,{key:1})):(x(),K(mn,{key:2})):(x(),K(ia,{key:0}))}});export{hn as default};
