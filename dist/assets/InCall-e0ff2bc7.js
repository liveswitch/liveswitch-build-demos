import{l as h,_ as He,V as he,e as M,a as ce,d as K,b as be,g as ke,h as Ve,i as Ae,j as Ue,k as _e,n as et,o as tt,p as at,q as nt,r as it,s as st,t as lt,u as ot,v as ct,R as ut,w as dt,x as rt,y as Ge,z as vt,A as mt,B as ft,C as gt,D as pt,E as ht,F as St,L as Ct,G as _t,H as yt,I as bt,J as kt,K as Vt,M as At,N as xt,O as De,P as $e,Q as wt,S as Fe,T as ee,U as Ye}from"./_plugin-vue_export-helper-7489abf7.js";import{d as Se,a as xe,b as we,r as w,o as Ie,e as x,f as E,h as o,c as i,j as J,v as Z,w as C,i as d,t as Q,x as ie,F as ue,y as de,n as Y,l as Me,q as Le,g as ve,m as Ce,z as je,u as me,p as pe,I as re,A as Te,B as It,C as Mt,D as B,E as Lt,G as Tt,H as Rt,J as ne,K as ge,L as Pt,s as We,M as ze,N as Ot,O as Xe,P as Ut,Q as Dt,R as $t,S as ae,T as zt}from"./index-de3f3c4f.js";import"./_commonjsHelpers-725317a4.js";const Nt="62c0809a-5671-426f-94a5-8edbdd1fe962",Bt="https://cloud.liveswitch.io",Et="/room/OHTest",Ht="0070c9c582894ef7969986ba228399c527201d910ed9451eb8b45097194ad689",W={applicationId:Nt,gatewayUrl:Bt,channelId:Et,sharedSecret:Ht},qe=e=>(Me("data-v-c57cf73f"),e=e(),Le(),e),Gt={class:"container"},Ft={class:"left-column"},Yt={class:"flex-center"},jt={class:"row-spread"},Wt={class:"user-counter"},Xt=qe(()=>o("i",{class:"icon-users users"},null,-1)),qt={class:"video-grid"},Jt={class:"right-column"},Qt={class:"settings-menu"},Kt={class:"row"},Zt={class:"row"},ea={class:"row"},ta={class:"chat-container"},aa=qe(()=>o("div",{class:"chat-header"},[o("h2",{class:"margin"},"Chat")],-1)),na={class:"chat-body"},ia={class:"chat-footer"},sa=Se({__name:"InCall",setup(e){const t=xe(),u=we();let c=w([]);const I=w(""),m=w(1),S=t.state.localMedia;let s=null,r=null,v=w({});const f=w("");let V=w([]);function _(){for(let b in v.value){const p=v.value[b].connection;(p.getState()!==h.ConnectionState.Closed.valueOf()||p.getState()!==h.ConnectionState.Closing)&&p.close(),delete v.value[b]}D(),u.push("/")}function k(b){debugger}function H(){if(f.value.length===0)return;let b=new Date;var p={from:t.state.displayName,timestamp:new Date().getTime(),timestampHourFormat:b.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),timestampDateFormat:b.toLocaleString(),text:f.value};s&&s.sendMessage(JSON.stringify(p)),f.value=""}Ie(async()=>{await F(),t.commit("setLocalMedia",S),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",S.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",S.getAudioSourceInput().getId()),t.commit("setVideoMuted",S.getVideoMuted()),t.commit("setAudioMuted",S.getAudioMuted()),s&&s.addOnMessage(function(b,p){var g=JSON.parse(p);console.log(p),V.value.push({user:g.from,message:g.text})})});async function F(){const b=new h.Promise;r=new h.Client(W.gatewayUrl,W.applicationId),r.setUserAlias(t.state.displayName);const p=h.Token.generateClientRegisterToken(W.applicationId,r.getUserId(),r.getDeviceId(),r.getId(),[new h.ChannelClaim(t.state.channelId)],W.sharedSecret);return r.register(p).then(g=>{z(g),b.resolve(null)}).fail(g=>{h.Log.error("Failed to register with Gateway."),b.reject(g)}),b}function z(b){s=b[0];const p=T(t.state.localMedia);t.commit("setUpstreamConnection",p),s&&s.addOnRemoteUpstreamConnectionOpen(g=>U(g,s))}function U(b,p){const g=new h.RemoteMedia,R=new h.AudioStream(g),N=new h.VideoStream(g);if(p){const O=p.createSfuDownstreamConnection(b,R,N);return v.value[O.getId()]={connection:O,media:g,index:m.value++,displayName:b.getUserAlias()},c.value.length===0&&g.getAudioSinkOutputs().then(function(L){c.value=L.map(l=>(l.getId()==="default"&&(I.value=l.getId()),{name:l.getName(),id:l.getId()}))}).fail(function(L){console.error(L)}),O.addOnStateChange(L=>{L.getRemoteClosed()&&(delete v.value[O.getId()],g.destroy(),m.value--)}),O.open(),O}}function T(b){const p=new h.AudioStream(b),g=new h.VideoStream(b);if(!s)return;const R=s.createSfuUpstreamConnection(p,g);return R.addOnStateChange(N=>{h.Log.debug(`Upstream connection is ${new h.ConnectionStateWrapper(N.getState()).toString()}.`)}),R.open(),R}function D(){if(r)return r.unregister().fail(()=>h.Log.error("Unregistration failed."))}return(b,p)=>(x(),E("div",Gt,[o("div",Ft,[o("div",Yt,[i(he,{src:He,class:"logo"})]),o("div",jt,[o("div",Wt,[Xt,J(" "+Z(m.value),1)]),i(M,{class:"leave-button",onClick:_},{default:C(()=>[J("Leave Call")]),_:1})]),o("div",qt,[d(t).state.localMedia?(x(),Q(ce,{key:0,class:"video","local-video":d(t).state.localMedia,userName:"Me"},null,8,["local-video"])):ie("",!0),d(v)?(x(!0),E(ue,{key:1},de(d(v),g=>(x(),Q(ce,{class:"video",remoteVideo:g.media,index:g.index,userName:g.displayName,connection:g.connection},null,8,["remoteVideo","index","userName","connection"]))),256)):ie("",!0)])]),o("div",Jt,[o("div",Qt,[o("div",Kt,[i(K,{label:"Camera",class:"margin input","hide-details":"auto",items:d(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:d(t).state.activeVideoDevice,"onUpdate:modelValue":[p[0]||(p[0]=g=>d(t).state.activeVideoDevice=g),p[1]||(p[1]=g=>d(t).commit("changeCamera"))]},null,8,["items","modelValue"]),i(M,{class:"margin button",icon:"",onClick:p[2]||(p[2]=g=>d(t).commit("toggleLocalVideoMute"))},{default:C(()=>[o("i",{class:Y(["center",d(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1})]),o("div",Zt,[i(K,{label:"Microphone",class:"margin input","hide-details":"auto",items:d(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:d(t).state.activeAudioDevice,"onUpdate:modelValue":[p[3]||(p[3]=g=>d(t).state.activeAudioDevice=g),p[4]||(p[4]=g=>d(t).commit("changeMicrophone"))]},null,8,["items","modelValue"]),i(M,{class:"margin button",icon:"",onClick:p[5]||(p[5]=g=>d(t).commit("toggleLocalAudioMute"))},{default:C(()=>[o("i",{class:Y(["center",d(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1})]),o("div",ea,[d(c).length>0?(x(),Q(K,{key:0,label:"Speaker",class:"margin input","hide-details":"auto",items:d(c),"item-title":"name","item-value":"id",modelValue:I.value,"onUpdate:modelValue":[p[6]||(p[6]=g=>I.value=g),k]},null,8,["items","modelValue"])):ie("",!0)])]),o("div",ta,[aa,o("div",na,[(x(!0),E(ue,null,de(d(V),g=>(x(),E("div",null,[o("div",{class:Y(["chat-message",g.user===d(t).state.displayName?"my-chat":"other-chat"])},Z(g.user)+": "+Z(g.message),3)]))),256))]),o("div",ia,[i(be,{label:"Chat Message",clearable:"",class:"margin chat-input","hide-details":"auto",modelValue:f.value,"onUpdate:modelValue":p[7]||(p[7]=g=>f.value=g)},null,8,["modelValue"]),i(M,{class:"chat-button",onClick:H},{default:C(()=>[J(" Send ")]),_:1})])])])]))}});const la=ke(sa,[["__scopeId","data-v-c57cf73f"]]);const oa=ve()({name:"VCardActions",props:Ce(),setup(e,t){let{slots:u}=t;return je({VBtn:{variant:"text"}}),me(()=>{var c;return i("div",{class:["v-card-actions",e.class],style:e.style},[(c=u.default)==null?void 0:c.call(u)])}),{}}}),ca=Ve("v-card-subtitle"),ua=Ve("v-card-title"),da=pe({appendAvatar:String,appendIcon:re,prependAvatar:String,prependIcon:re,subtitle:String,title:String,...Ce(),...Ae()},"VCardItem"),ra=ve()({name:"VCardItem",props:da(),setup(e,t){let{slots:u}=t;return me(()=>{var v;const c=!!(e.prependAvatar||e.prependIcon),I=!!(c||u.prepend),m=!!(e.appendAvatar||e.appendIcon),S=!!(m||u.append),s=!!(e.title||u.title),r=!!(e.subtitle||u.subtitle);return i("div",{class:["v-card-item",e.class],style:e.style},[I&&i("div",{key:"prepend",class:"v-card-item__prepend"},[u.prepend?i(_e,{key:"prepend-defaults",disabled:!c,defaults:{VAvatar:{density:e.density,icon:e.prependIcon,image:e.prependAvatar}}},u.prepend):c&&i(Ue,{key:"prepend-avatar",density:e.density,icon:e.prependIcon,image:e.prependAvatar},null)]),i("div",{class:"v-card-item__content"},[s&&i(ua,{key:"title"},{default:()=>{var f;return[((f=u.title)==null?void 0:f.call(u))??e.title]}}),r&&i(ca,{key:"subtitle"},{default:()=>{var f;return[((f=u.subtitle)==null?void 0:f.call(u))??e.subtitle]}}),(v=u.default)==null?void 0:v.call(u)]),S&&i("div",{key:"append",class:"v-card-item__append"},[u.append?i(_e,{key:"append-defaults",disabled:!m,defaults:{VAvatar:{density:e.density,icon:e.appendIcon,image:e.appendAvatar}}},u.append):m&&i(Ue,{key:"append-avatar",density:e.density,icon:e.appendIcon,image:e.appendAvatar},null)])])}),{}}}),va=Ve("v-card-text"),ma=pe({appendAvatar:String,appendIcon:re,disabled:Boolean,flat:Boolean,hover:Boolean,image:String,link:{type:Boolean,default:void 0},prependAvatar:String,prependIcon:re,ripple:{type:[Boolean,Object],default:!0},subtitle:String,text:String,title:String,...et(),...Ce(),...Ae(),...tt(),...at(),...nt(),...it(),...st(),...lt(),...ot(),...Te(),...It(),...ct({variant:"elevated"})},"VCard"),Je=ve()({name:"VCard",directives:{Ripple:ut},props:ma(),setup(e,t){let{attrs:u,slots:c}=t;const{themeClasses:I}=Mt(e),{borderClasses:m}=dt(e),{colorClasses:S,colorStyles:s,variantClasses:r}=rt(e),{densityClasses:v}=Ge(e),{dimensionStyles:f}=vt(e),{elevationClasses:V}=mt(e),{loaderClasses:_}=ft(e),{locationStyles:k}=gt(e),{positionClasses:H}=pt(e),{roundedClasses:F}=ht(e),z=St(e,u),U=B(()=>e.link!==!1&&z.isLink.value),T=B(()=>!e.disabled&&e.link!==!1&&(e.link||z.isClickable.value));return me(()=>{const D=U.value?"a":e.tag,b=!!(c.title||e.title),p=!!(c.subtitle||e.subtitle),g=b||p,R=!!(c.append||e.appendAvatar||e.appendIcon),N=!!(c.prepend||e.prependAvatar||e.prependIcon),O=!!(c.image||e.image),L=g||N||R,l=!!(c.text||e.text);return Lt(i(D,{class:["v-card",{"v-card--disabled":e.disabled,"v-card--flat":e.flat,"v-card--hover":e.hover&&!(e.disabled||e.flat),"v-card--link":T.value},I.value,m.value,S.value,v.value,V.value,_.value,H.value,F.value,r.value,e.class],style:[s.value,f.value,k.value,e.style],href:z.href.value,onClick:T.value&&z.navigate,tabindex:e.disabled?-1:void 0},{default:()=>{var n;return[O&&i("div",{key:"image",class:"v-card__image"},[c.image?i(_e,{key:"image-defaults",disabled:!e.image,defaults:{VImg:{cover:!0,src:e.image}}},c.image):i(he,{key:"image-img",cover:!0,src:e.image},null)]),i(Ct,{name:"v-card",active:!!e.loading,color:typeof e.loading=="boolean"?void 0:e.loading},{default:c.loader}),L&&i(ra,{key:"item",prependAvatar:e.prependAvatar,prependIcon:e.prependIcon,title:e.title,subtitle:e.subtitle,appendAvatar:e.appendAvatar,appendIcon:e.appendIcon},{default:c.item,prepend:c.prepend,title:c.title,subtitle:c.subtitle,append:c.append}),l&&i(va,{key:"text"},{default:()=>{var a;return[((a=c.text)==null?void 0:a.call(c))??e.text]}}),(n=c.default)==null?void 0:n.call(c),c.actions&&i(oa,null,{default:c.actions}),_t(T.value,"v-card")]}}),[[Tt("ripple"),T.value&&e.ripple]])}),{}}});const Qe=Symbol.for("vuetify:v-tabs"),fa=pe({fixed:Boolean,sliderColor:String,hideSlider:Boolean,direction:{type:String,default:"horizontal"},...Rt(yt({selectedClass:"v-tab--selected",variant:"text"}),["active","block","flat","location","position","symbol"])},"VTab"),ye=ve()({name:"VTab",props:fa(),setup(e,t){let{slots:u,attrs:c}=t;const{textColorClasses:I,textColorStyles:m}=bt(e,"sliderColor"),S=B(()=>e.direction==="horizontal"),s=ne(!1),r=w(),v=w();function f(V){var k,H;let{value:_}=V;if(s.value=_,_){const F=(H=(k=r.value)==null?void 0:k.$el.parentElement)==null?void 0:H.querySelector(".v-tab--selected .v-tab__slider"),z=v.value;if(!F||!z)return;const U=getComputedStyle(F).color,T=F.getBoundingClientRect(),D=z.getBoundingClientRect(),b=S.value?"x":"y",p=S.value?"X":"Y",g=S.value?"right":"bottom",R=S.value?"width":"height",N=T[b],O=D[b],L=N>O?T[g]-D[g]:T[b]-D[b],l=Math.sign(L)>0?S.value?"right":"bottom":Math.sign(L)<0?S.value?"left":"top":"center",a=(Math.abs(L)+(Math.sign(L)<0?T[R]:D[R]))/Math.max(T[R],D[R])||0,$=T[R]/D[R]||0,j=1.5;kt(z,{backgroundColor:[U,"currentcolor"],transform:[`translate${p}(${L}px) scale${p}(${$})`,`translate${p}(${L/j}px) scale${p}(${(a-1)/j+1})`,"none"],transformOrigin:Array(3).fill(l)},{duration:225,easing:Vt})}}return me(()=>{const[V]=M.filterProps(e);return i(M,ge({symbol:Qe,ref:r,class:["v-tab",e.class],style:e.style,tabindex:s.value?0:-1,role:"tab","aria-selected":String(s.value),active:!1},V,c,{block:e.fixed,maxWidth:e.fixed?300:void 0,"onGroup:selected":f}),{default:()=>{var _;return[((_=u.default)==null?void 0:_.call(u))??e.text,!e.hideSlider&&i("div",{ref:v,class:["v-tab__slider",I.value],style:m.value},null)]}})}),{}}});function Ne(e){const u=Math.abs(e);return Math.sign(e)*(u/((1/.501-2)*(1-u)+1))}function Be(e){let{selectedElement:t,containerSize:u,contentSize:c,isRtl:I,currentScrollOffset:m,isHorizontal:S}=e;const s=S?t.clientWidth:t.clientHeight,r=S?t.offsetLeft:t.offsetTop,v=I&&S?c-r-s:r,f=u+m,V=s+v,_=s*.4;return v<=m?m=Math.max(v-_,0):f<=V&&(m=Math.min(m-(f-V-_),c-u)),m}function ga(e){let{selectedElement:t,containerSize:u,contentSize:c,isRtl:I,isHorizontal:m}=e;const S=m?t.clientWidth:t.clientHeight,s=m?t.offsetLeft:t.offsetTop,r=I&&m?c-s-S/2-u/2:s+S/2-u/2;return Math.min(c-u,Math.max(0,r))}const pa=Symbol.for("vuetify:v-slide-group"),Ke=pe({centerActive:Boolean,direction:{type:String,default:"horizontal"},symbol:{type:null,default:pa},nextIcon:{type:re,default:"$next"},prevIcon:{type:re,default:"$prev"},showArrows:{type:[Boolean,String],validator:e=>typeof e=="boolean"||["always","desktop","mobile"].includes(e)},...Ce(),...Te(),...At({selectedClass:"v-slide-group-item--active"})},"VSlideGroup"),Ee=ve()({name:"VSlideGroup",props:Ke(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:u}=t;const{isRtl:c}=Pt(),{mobile:I}=We(),m=xt(e,e.symbol),S=ne(!1),s=ne(0),r=ne(0),v=ne(0),f=B(()=>e.direction==="horizontal"),{resizeRef:V,contentRect:_}=ze(),{resizeRef:k,contentRect:H}=ze(),F=B(()=>m.selected.value.length?m.items.value.findIndex(y=>y.id===m.selected.value[0]):-1),z=B(()=>m.selected.value.length?m.items.value.findIndex(y=>y.id===m.selected.value[m.selected.value.length-1]):-1);if(Ot){let y=-1;Xe(()=>[m.selected.value,_.value,H.value,f.value],()=>{cancelAnimationFrame(y),y=requestAnimationFrame(()=>{if(_.value&&H.value){const A=f.value?"width":"height";r.value=_.value[A],v.value=H.value[A],S.value=r.value+1<v.value}if(F.value>=0&&k.value){const A=k.value.children[z.value];F.value===0||!S.value?s.value=0:e.centerActive?s.value=ga({selectedElement:A,containerSize:r.value,contentSize:v.value,isRtl:c.value,isHorizontal:f.value}):S.value&&(s.value=Be({selectedElement:A,containerSize:r.value,contentSize:v.value,isRtl:c.value,currentScrollOffset:s.value,isHorizontal:f.value}))}})})}const U=ne(!1);let T=0,D=0;function b(y){const A=f.value?"clientX":"clientY";D=(c.value&&f.value?-1:1)*s.value,T=y.touches[0][A],U.value=!0}function p(y){if(!S.value)return;const A=f.value?"clientX":"clientY",q=c.value&&f.value?-1:1;s.value=q*(D+T-y.touches[0][A])}function g(y){const A=v.value-r.value;s.value<0||!S.value?s.value=0:s.value>=A&&(s.value=A),U.value=!1}function R(){V.value&&(V.value[f.value?"scrollLeft":"scrollTop"]=0)}const N=ne(!1);function O(y){if(N.value=!0,!(!S.value||!k.value)){for(const A of y.composedPath())for(const q of k.value.children)if(q===A){s.value=Be({selectedElement:q,containerSize:r.value,contentSize:v.value,isRtl:c.value,currentScrollOffset:s.value,isHorizontal:f.value});return}}}function L(y){N.value=!1}function l(y){var A;!N.value&&!(y.relatedTarget&&((A=k.value)!=null&&A.contains(y.relatedTarget)))&&a()}function n(y){k.value&&(f.value?y.key==="ArrowRight"?a(c.value?"prev":"next"):y.key==="ArrowLeft"&&a(c.value?"next":"prev"):y.key==="ArrowDown"?a("next"):y.key==="ArrowUp"&&a("prev"),y.key==="Home"?a("first"):y.key==="End"&&a("last"))}function a(y){var A,q,Re,Pe,Oe;if(k.value)if(!y)(A=Ut(k.value)[0])==null||A.focus();else if(y==="next"){const se=(q=k.value.querySelector(":focus"))==null?void 0:q.nextElementSibling;se?se.focus():a("first")}else if(y==="prev"){const se=(Re=k.value.querySelector(":focus"))==null?void 0:Re.previousElementSibling;se?se.focus():a("last")}else y==="first"?(Pe=k.value.firstElementChild)==null||Pe.focus():y==="last"&&((Oe=k.value.lastElementChild)==null||Oe.focus())}function $(y){const A=s.value+(y==="prev"?-1:1)*r.value;s.value=Dt(A,0,v.value-r.value)}const j=B(()=>{let y=s.value>v.value-r.value?-(v.value-r.value)+Ne(v.value-r.value-s.value):-s.value;s.value<=0&&(y=Ne(-s.value));const A=c.value&&f.value?-1:1;return{transform:`translate${f.value?"X":"Y"}(${A*y}px)`,transition:U.value?"none":"",willChange:U.value?"transform":""}}),P=B(()=>({next:m.next,prev:m.prev,select:m.select,isSelected:m.isSelected})),G=B(()=>{switch(e.showArrows){case"always":return!0;case"desktop":return!I.value;case!0:return S.value||Math.abs(s.value)>0;case"mobile":return I.value||S.value||Math.abs(s.value)>0;default:return!I.value&&(S.value||Math.abs(s.value)>0)}}),X=B(()=>Math.abs(s.value)>0),Ze=B(()=>v.value>Math.abs(s.value)+r.value);return me(()=>i(e.tag,{class:["v-slide-group",{"v-slide-group--vertical":!f.value,"v-slide-group--has-affixes":G.value,"v-slide-group--is-overflowing":S.value},e.class],style:e.style,tabindex:N.value||m.selected.value.length?-1:0,onFocus:l},{default:()=>{var y,A,q;return[G.value&&i("div",{key:"prev",class:["v-slide-group__prev",{"v-slide-group__prev--disabled":!X.value}],onClick:()=>$("prev")},[((y=u.prev)==null?void 0:y.call(u,P.value))??i(De,null,{default:()=>[i($e,{icon:c.value?e.nextIcon:e.prevIcon},null)]})]),i("div",{key:"container",ref:V,class:"v-slide-group__container",onScroll:R},[i("div",{ref:k,class:"v-slide-group__content",style:j.value,onTouchstartPassive:b,onTouchmovePassive:p,onTouchendPassive:g,onFocusin:O,onFocusout:L,onKeydown:n},[(A=u.default)==null?void 0:A.call(u,P.value)])]),G.value&&i("div",{key:"next",class:["v-slide-group__next",{"v-slide-group__next--disabled":!Ze.value}],onClick:()=>$("next")},[((q=u.next)==null?void 0:q.call(u,P.value))??i(De,null,{default:()=>[i($e,{icon:c.value?e.prevIcon:e.nextIcon},null)]})])]}})),{selected:m.selected,scrollTo:$,scrollOffset:s,focus:a}}});function ha(e){return e?e.map(t=>typeof t=="string"?{title:t,value:t}:t):[]}const Sa=pe({alignTabs:{type:String,default:"start"},color:String,fixedTabs:Boolean,items:{type:Array,default:()=>[]},stacked:Boolean,bgColor:String,grow:Boolean,height:{type:[Number,String],default:void 0},hideSlider:Boolean,sliderColor:String,...Ke({mandatory:"force"}),...Ae(),...Te()},"VTabs"),Ca=ve()({name:"VTabs",props:Sa(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:u}=t;const c=$t(e,"modelValue"),I=B(()=>ha(e.items)),{densityClasses:m}=Ge(e),{backgroundColorClasses:S,backgroundColorStyles:s}=wt(ae(e,"bgColor"));return je({VTab:{color:ae(e,"color"),direction:ae(e,"direction"),stacked:ae(e,"stacked"),fixed:ae(e,"fixedTabs"),sliderColor:ae(e,"sliderColor"),hideSlider:ae(e,"hideSlider")}}),me(()=>{const[r]=Ee.filterProps(e);return i(Ee,ge(r,{modelValue:c.value,"onUpdate:modelValue":v=>c.value=v,class:["v-tabs",`v-tabs--${e.direction}`,`v-tabs--align-tabs-${e.alignTabs}`,{"v-tabs--fixed-tabs":e.fixedTabs,"v-tabs--grow":e.grow,"v-tabs--stacked":e.stacked},m.value,S.value,e.class],style:[{"--v-tabs-height":zt(e.height)},s.value,e.style],role:"tablist",symbol:Qe}),{default:()=>[u.default?u.default():I.value.map(v=>i(ye,ge(v,{key:v.title}),null))]})}),{}}}),fe=e=>(Me("data-v-e2c6dad3"),e=e(),Le(),e),_a={class:"container"},ya={class:"column"},ba={class:"margin spread"},ka={class:"row"},Va=fe(()=>o("i",{class:"center icon-cog-gear"},null,-1)),Aa=fe(()=>o("h3",null,"Settings",-1)),xa={class:"users-container"},wa=fe(()=>o("i",{class:"icon-users users"},null,-1)),Ia={class:"button-wrapper"},Ma={class:"tab-container"},La={key:0},Ta={class:"basic-flex"},Ra={class:"even-spacing"},Pa={class:"video-container"},Oa={class:"video-container"},Ua={class:"controls-container"},Da=fe(()=>o("i",{class:"center icon-caret-left-md"},null,-1)),$a={class:"row-center"},za=fe(()=>o("i",{class:"center icon-caret-right-md"},null,-1)),Na={key:1,class:"chat-container"},Ba=fe(()=>o("div",{class:"chat-header"},[o("h3",null,"Chat")],-1)),Ea={class:"chat-body"},Ha={class:"chat-footer"},Ga={class:"tab-buttons"},le=2,Fa=Se({__name:"InCallPortrait",setup(e){const t=xe(),u=we(),c=B(()=>t.state.pinLocal||r.value===1),I=B(()=>{let l=1;return t.state.pinLocal?l=s.value-1:l=Math.ceil(s.value/le),l});Xe(t.state.pinLocal,U);let m=w([]);const S=w(""),s=w(1),r=w(1),v=t.state.localMedia;let f=null,V=null,_=w({});const k=w("");let H=w([]);function F(){r.value*le-1<s.value&&(r.value++,U())}function z(){r.value>1&&(r.value--,U())}function U(){let l=new Array;if(t.state.pinLocal||r.value===1)for(let n in _.value){let a=_.value[n];a.index===r.value&&l.push(a)}else for(let n in _.value){let a=_.value[n];(a.index===r.value*le-le||a.index===r.value*le-1)&&l.push(a)}t.commit("setVideoList",l)}function T(){for(let l in _.value){const n=_.value[l].connection;(n.getState()!==h.ConnectionState.Closed.valueOf()||n.getState()!==h.ConnectionState.Closing)&&n.close(),delete _.value[l]}N(),u.push("/")}function D(){if(k.value.length===0)return;let l=new Date;var n={from:t.state.displayName,timestamp:new Date().getTime(),timestampHourFormat:l.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),timestampDateFormat:l.toLocaleString(),text:k.value};f&&f.sendMessage(JSON.stringify(n)),k.value=""}Ie(async()=>{await b(),t.commit("setLocalMedia",v),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",v.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",v.getAudioSourceInput().getId()),t.commit("setVideoMuted",v.getVideoMuted()),t.commit("setAudioMuted",v.getAudioMuted()),f&&f.addOnMessage(function(l,n){var a=JSON.parse(n);console.log(n),H.value.push({user:a.from,message:a.text})})});async function b(){const l=new h.Promise;V=new h.Client(W.gatewayUrl,W.applicationId),V.setUserAlias(t.state.displayName);const n=h.Token.generateClientRegisterToken(W.applicationId,V.getUserId(),V.getDeviceId(),V.getId(),[new h.ChannelClaim(t.state.channelId)],W.sharedSecret);return V.register(n).then(a=>{p(a),l.resolve(null)}).fail(a=>{h.Log.error("Failed to register with Gateway."),l.reject(a)}),l}function p(l){f=l[0];const n=R(t.state.localMedia);t.commit("setUpstreamConnection",n),f&&f.addOnRemoteUpstreamConnectionOpen(a=>g(a,f))}function g(l,n){const a=new h.RemoteMedia,$=new h.AudioStream(a),j=new h.VideoStream(a);if(n){const P=n.createSfuDownstreamConnection(l,$,j);return s.value===1&&t.commit("setVideoList",[{connection:P,media:a,index:s.value,displayName:l.getUserAlias()}]),_.value[P.getId()]={connection:P,media:a,index:s.value++,displayName:l.getUserAlias()},m.value.length===0&&a.getAudioSinkOutputs().then(function(G){m.value=G.map(X=>(X.getId()==="default"&&(S.value=X.getId()),{name:X.getName(),id:X.getId()}))}).fail(function(G){console.error(G)}),P.addOnStateChange(G=>{G.getRemoteClosed()&&(delete _.value[P.getId()],a.destroy(),s.value--)}),P.open(),P}}function R(l){const n=new h.AudioStream(l),a=new h.VideoStream(l);if(!f)return;const $=f.createSfuUpstreamConnection(n,a);return $.addOnStateChange(j=>{h.Log.debug(`Upstream connection is ${new h.ConnectionStateWrapper(j.getState()).toString()}.`)}),$.open(),$}function N(){if(V)return V.unregister().fail(()=>h.Log.error("Unregistration failed."))}const O=w("GALLERY");function L(l){O.value=l.target.innerText}return(l,n)=>(x(),E("div",_a,[o("div",ya,[i(he,{src:He,class:"logo"}),o("div",ba,[o("div",ka,[i(Ye,{"close-on-content-click":!1,location:"bottom"},{activator:C(({props:a})=>[i(M,ge(a,{icon:"",class:"icon",flat:""}),{default:C(()=>[Va]),_:2},1040)]),default:C(()=>[i(Je,{class:"settings-menu"},{default:C(()=>[i(Fe,null,{default:C(()=>[i(ee,null,{default:C(()=>[Aa]),_:1}),i(ee,null,{default:C(()=>[i(K,{label:"Camera",class:"margin input","hide-details":"auto",items:d(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:d(t).state.activeVideoDevice,"onUpdate:modelValue":[n[0]||(n[0]=a=>d(t).state.activeVideoDevice=a),n[1]||(n[1]=a=>d(t).commit("changeCamera"))]},null,8,["items","modelValue"])]),_:1}),i(ee,null,{default:C(()=>[i(K,{label:"Microphone",class:"margin input","hide-details":"auto",items:d(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:d(t).state.activeAudioDevice,"onUpdate:modelValue":[n[2]||(n[2]=a=>d(t).state.activeAudioDevice=a),n[3]||(n[3]=a=>d(t).commit("changeMicrophone"))]},null,8,["items","modelValue"])]),_:1}),i(ee,null,{default:C(()=>[i(K,{label:"Speaker",class:"margin input","hide-details":"auto"})]),_:1})]),_:1})]),_:1})]),_:1}),o("div",xa,[wa,J(" "+Z(s.value),1)])]),o("div",Ia,[i(M,{class:"leave-button",onClick:T},{default:C(()=>[J("Leave")]),_:1})])]),o("div",Ma,[O.value==="GALLERY"?(x(),E("div",La,[o("div",Ta,[o("div",Ra,[o("div",Pa,[d(t).state.localMedia&&c.value?(x(),Q(ce,{key:0,"ask-height":"240px","ask-width":"320px","local-video":d(t).state.localMedia,userName:"Me"},null,8,["local-video"])):ie("",!0)]),o("div",Oa,[d(t).state.videoList?(x(!0),E(ue,{key:0},de(d(t).state.videoList,a=>(x(),Q(ce,{remoteVideo:a.media,index:a.index,userName:a.displayName,connection:a.connection,"ask-height":"240px","ask-width":"320px",maxIndex:le},null,8,["remoteVideo","index","userName","connection"]))),256)):ie("",!0)])])]),o("div",Ua,[i(M,{class:Y(["margin align-left",r.value===1?"inactive-button":"active-button"]),icon:"",onClick:z},{default:C(()=>[Da]),_:1},8,["class"]),o("div",$a,[i(M,{class:"margin active-button",icon:"",onClick:n[4]||(n[4]=a=>d(t).commit("toggleLocalVideoMute"))},{default:C(()=>[o("i",{class:Y(["center",d(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1}),i(M,{class:"margin active-button",icon:"",onClick:n[5]||(n[5]=a=>d(t).commit("toggleLocalAudioMute"))},{default:C(()=>[o("i",{class:Y(["center",d(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1})]),i(M,{class:Y(["margin active-button align-right",r.value===I.value?"inactive-button":"active-button"]),icon:"",onClick:F},{default:C(()=>[za]),_:1},8,["class"])])])):(x(),E("div",Na,[Ba,o("div",Ea,[(x(!0),E(ue,null,de(d(H),a=>(x(),E("div",null,[o("div",{class:Y(["chat-message",a.user===d(t).state.displayName?"my-chat":"other-chat"])},Z(a.user)+": "+Z(a.message),3)]))),256))]),o("div",Ha,[i(be,{label:"Chat Message",clearable:"",class:"margin chat-input","hide-details":"auto",modelValue:k.value,"onUpdate:modelValue":n[6]||(n[6]=a=>k.value=a)},null,8,["modelValue"]),i(M,{class:"chat-button",onClick:D},{default:C(()=>[J("Send")]),_:1})])]))]),o("div",Ga,[i(Ca,{"fixed-tabs":"","selected-class":"activeTab",class:"tabs",onClick:L},{default:C(()=>[i(ye,{value:"gallery"},{default:C(()=>[J("Gallery")]),_:1}),i(ye,{value:"chat"},{default:C(()=>[J("Chat")]),_:1})]),_:1})])])]))}});const Ya=ke(Fa,[["__scopeId","data-v-e2c6dad3"]]),ja="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAzCAYAAADVY1sUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAATLSURBVHgBzVrtcdw2EH3U+L/jCkKlgERxA6bVQKQKxLgB0S4goSqQ1EBySgGR3UDCVCC5gYgd+FwBjMclxY8jsCB5N3dvBpwTAQJ8u4vdxVIRDgGZ4fU7RLiAwZn9fVL9LXis2x1uosI1RYR9Q0j8zl9oX96Ff217ZwmVw479ERECx7b9DdFAKIx9619xHd11b+6HSEviH9tiTMcGmTAimaHE2Na2FVa1a8xFOIkb264g5pZCzK+LL7a9bszsBdwLcoJL9G13bR98hWWg8P6An8SVXSd/XjMzJPTGtqQz5lU9zyn/OBqdJjOxvT7YlqO/AUssQbuxE8+opw6JLj6P3EtqgY8QERL0DvHIg/NNSkCTuvT0k+k7x/3PjmdSXsY0kmPeBgwBteFzsaUvVoyAZvojf/SJiDYusAvoc9MTXXn6XQKIeRlqJMHukKsjDP7z9L709G0Q0QJTjPl4o/R/GovYNWhCP3me3SCipQhx4yUmITNn8AuBZvURfriE/JWXIZEQrzQlnWig7bv1MOV4hrjsGG5BVN5sSOQROs4wBbLJtWc0bSSO+9Qk490GEW1C4mKieSVKP0X+l6ef++M3z9OVg+gTkRyqgB8kkSEcl0q/O3aIWSVwm9Vz3jcWEH2+vH05MRk/ZIy2pz55+nzaoFk976tNIiKdW/hBrdxDh6Y541xLtJHCbZpl10EcOQbl0Df+iV3sT2XML0p/MRo72lTfp42e5YwTEbs7h57tpnbR+9HNn5kEeuy4c/RpqX45dNcujaCW1FvoZOhaH0b2TAoNYylJZhoSieMpHqhOhzfdRAgh8zPglFyDGDxH0NRaQppZ9VMSmlNmmsNS6nhG0vxFxYfMcONeIizfKuCPH/0zt+wJan/KybGHacUHkXaO5an+k20/QF46qedLPONpTh8siZVrwDQiDbZHKARMQWhOXi86j0gDIZRAl+gc0HPeukxpiO3VtVpS19CPAz4UVUpvqhJpcI0g8rwYXyZGm2Ks61Y6D0BC5gnhKOs56YZpOh/n1sxeDF6kW0hOnE9lZl0vzBcoOklfSEryGiKMpRWZHqLOy1HyzJ9iTEeJ1uXGnnGU+Dl2ANGIpBMkMde2Y4RE8ggr7AiRUpBrUKBNVTiu+/0iFDSnY+wI1EgOX3IGG4HHDj6ixRThsURLcxaBGqGXiR3955aE//grGmU6n8CP0q6WO4sMC0EiBq6FQ03BL4whnF+dloDZr8sNhrnHzKSY5umYHA4z5cUgEZeqT9SFxGVfYx5S8GPPe7OVfI1EbuCW/r2TzHvDlJ5m4q+u+zV7bEPkyq7x/1LtSECUs4ZPsis78tEuyvIktUApau6Xkf9tPU5z7+06cuYoMRHdyJ5j8zvdXDBrzTpzxxBBhVYpV5hIqJ80hgVHH0q44o7Mn2OasFYQoail3MixYIppZ4yiSj+0GCFHWtYA+G09Rjge7Py3VbHCoaVIWZj2nUD2xfedxUtIOX966t1W13PMO2GW9brdb4ovt3ewmgohlGM7+/Jhf0SI5f8BQXCSD/sl0kCKcvRqWuV+DEyPTg+DCCHaoXsmoTjwKak6Wq92hEPBTSVTZtoMoiEZcqWJxjUfjka6aD/wpJDSazeLGK2yHCaRLpr/rmPzRPpvTn6IoHFFRiQAAAAASUVORK5CYII=",te=e=>(Me("data-v-a2b8af59"),e=e(),Le(),e),Wa={class:"container"},Xa={key:0,class:"tab-container"},qa={class:"video-container"},Ja={class:"basic-flex"},Qa={class:"controls-container"},Ka=te(()=>o("i",{class:"center icon-caret-left-md"},null,-1)),Za=te(()=>o("i",{class:"center icon-caret-right-md"},null,-1)),en={key:1},tn={class:"chat-container"},an=te(()=>o("div",{class:"chat-header"},[o("h3",null,"Chat")],-1)),nn={class:"chat-body"},sn={class:"basic-flex"},ln={class:"right-column"},on={class:"center user-container"},cn=te(()=>o("i",{class:"icon-users users"},null,-1)),un=te(()=>o("i",{class:"center icon-cog-gear"},null,-1)),dn=te(()=>o("h3",null,"Settings",-1)),rn=te(()=>o("i",{class:"center icon-chat"},null,-1)),vn=te(()=>o("i",{class:"center icon-video"},null,-1)),oe=2,mn=Se({__name:"InCallLandscape",setup(e){const t=xe(),u=we();let c=w([]);const I=w(""),m=w(1),S=t.state.localMedia;let s=null,r=null,v=w({});const f=w("");let V=w([]);const _=w(1),k=B(()=>t.state.pinLocal||_.value===1),H=B(()=>t.state.pinLocal?m.value-1:Math.ceil(m.value/oe));function F(){_.value*oe-1<m.value&&(_.value++,U())}function z(){_.value>1&&(_.value--,U())}function U(){let l=new Array;if(t.state.pinLocal||_.value===1)for(let n in v.value){let a=v.value[n];a.index===_.value&&l.push(a)}else for(let n in v.value){let a=v.value[n];(a.index===_.value*oe-oe||a.index===_.value*oe-1)&&l.push(a)}t.commit("setVideoList",l)}function T(){for(let l in v.value){const n=v.value[l].connection;(n.getState()!==h.ConnectionState.Closed.valueOf()||n.getState()!==h.ConnectionState.Closing)&&n.close(),delete v.value[l]}N(),u.push("/")}function D(){if(f.value.length===0)return;let l=new Date;var n={from:t.state.displayName,timestamp:new Date().getTime(),timestampHourFormat:l.toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),timestampDateFormat:l.toLocaleString(),text:f.value};s&&s.sendMessage(JSON.stringify(n)),f.value=""}Ie(async()=>{await b(),t.commit("setLocalMedia",S),t.commit("populateCameraList"),t.commit("populateMicrophoneList"),t.commit("setActiveVideoDevice",S.getVideoSourceInput().getId()),t.commit("setActiveAudioDevice",S.getAudioSourceInput().getId()),t.commit("setVideoMuted",S.getVideoMuted()),t.commit("setAudioMuted",S.getAudioMuted()),s&&s.addOnMessage(function(l,n){var a=JSON.parse(n);console.log(n),V.value.push({user:a.from,message:a.text})})});async function b(){const l=new h.Promise;r=new h.Client(W.gatewayUrl,W.applicationId),r.setUserAlias(t.state.displayName);const n=h.Token.generateClientRegisterToken(W.applicationId,r.getUserId(),r.getDeviceId(),r.getId(),[new h.ChannelClaim(t.state.channelId)],W.sharedSecret);return r.register(n).then(a=>{p(a),l.resolve(null)}).fail(a=>{h.Log.error("Failed to register with Gateway."),l.reject(a)}),l}function p(l){s=l[0];const n=R(t.state.localMedia);t.commit("setUpstreamConnection",n),s&&s.addOnRemoteUpstreamConnectionOpen(a=>g(a,s))}function g(l,n){const a=new h.RemoteMedia,$=new h.AudioStream(a),j=new h.VideoStream(a);if(n){const P=n.createSfuDownstreamConnection(l,$,j);return m.value===1&&t.commit("setVideoList",[{connection:P,media:a,index:m.value,displayName:l.getUserAlias()}]),v.value[P.getId()]={connection:P,media:a,index:m.value++,displayName:l.getUserAlias()},c.value.length===0&&a.getAudioSinkOutputs().then(function(G){c.value=G.map(X=>(X.getId()==="default"&&(I.value=X.getId()),{name:X.getName(),id:X.getId()}))}).fail(function(G){console.error(G)}),P.addOnStateChange(G=>{G.getRemoteClosed()&&(delete v.value[P.getId()],a.destroy(),m.value--)}),P.open(),P}}function R(l){const n=new h.AudioStream(l),a=new h.VideoStream(l);if(!s)return;const $=s.createSfuUpstreamConnection(n,a);return $.addOnStateChange(j=>{h.Log.debug(`Upstream connection is ${new h.ConnectionStateWrapper(j.getState()).toString()}.`)}),$.open(),$}function N(){if(r)return r.unregister().fail(()=>h.Log.error("Unregistration failed."))}const O=w("GALLERY");function L(l){O.value=l}return(l,n)=>(x(),E("div",Wa,[o("div",null,[O.value=="GALLERY"?(x(),E("div",Xa,[o("div",qa,[o("div",null,[d(t).state.localMedia&&k.value?(x(),Q(ce,{key:0,"ask-height":"265px","ask-width":"280px","local-video":d(t).state.localMedia,userName:"Me"},null,8,["local-video"])):ie("",!0)]),o("div",Ja,[d(t).state.videoList?(x(!0),E(ue,{key:0},de(d(t).state.videoList,a=>(x(),Q(ce,{remoteVideo:a.media,index:a.index,userName:a.displayName,connection:a.connection,"ask-height":"265px","ask-width":"280px",maxIndex:oe},null,8,["remoteVideo","index","userName","connection"]))),256)):ie("",!0)])]),o("div",Qa,[i(M,{class:Y(["margin align-left",_.value===1?"inactive-button":"active-button"]),icon:"",onClick:z},{default:C(()=>[Ka]),_:1},8,["class"]),i(M,{class:"margin active-button",icon:"",onClick:n[0]||(n[0]=a=>d(t).commit("toggleLocalVideoMute"))},{default:C(()=>[o("i",{class:Y(["center",d(t).state.videoMuted?"icon-video-slash":"icon-video"])},null,2)]),_:1}),i(M,{class:"margin active-button",icon:"",onClick:n[1]||(n[1]=a=>d(t).commit("toggleLocalAudioMute"))},{default:C(()=>[o("i",{class:Y(["center",d(t).state.audioMuted?"icon-audio-mic-slash":"icon-audio-mic"])},null,2)]),_:1}),i(M,{class:Y(["margin align-right",_.value===H.value?"inactive-button":"active-button"]),icon:"",onClick:F},{default:C(()=>[Za]),_:1},8,["class"])])])):(x(),E("div",en,[o("div",tn,[an,o("div",nn,[(x(!0),E(ue,null,de(d(V),a=>(x(),E("div",null,[o("div",{class:Y(["chat-message",a.user===d(t).state.displayName?"my-chat":"other-chat"])},Z(a.user)+": "+Z(a.message),3)]))),256))]),o("div",sn,[i(be,{label:"Chat Message",clearable:"",class:"chat-input","hide-details":"auto",modelValue:f.value,"onUpdate:modelValue":n[2]||(n[2]=a=>f.value=a)},null,8,["modelValue"]),i(M,{class:"chat-button",onClick:D},{default:C(()=>[J("Send")]),_:1})])])]))]),o("div",ln,[i(he,{src:ja,class:"logo"}),o("span",on,[cn,J(" "+Z(m.value),1)]),i(Ye,{"close-on-content-click":!1,location:"left"},{activator:C(({props:a})=>[i(M,ge({class:"margin center icon"},a,{icon:"",flat:""}),{default:C(()=>[un]),_:2},1040)]),default:C(()=>[i(Je,{class:"settings-menu"},{default:C(()=>[i(Fe,null,{default:C(()=>[i(ee,null,{default:C(()=>[dn]),_:1}),i(ee,null,{default:C(()=>[i(K,{label:"Camera",class:"margin input","hide-details":"auto",items:d(t).state.cameraList,"item-title":"name","item-value":"id",modelValue:d(t).state.activeVideoDevice,"onUpdate:modelValue":[n[3]||(n[3]=a=>d(t).state.activeVideoDevice=a),n[4]||(n[4]=a=>d(t).commit("changeCamera"))]},null,8,["items","modelValue"])]),_:1}),i(ee,null,{default:C(()=>[i(K,{label:"Microphone",class:"margin input","hide-details":"auto",items:d(t).state.microphoneList,"item-title":"name","item-value":"id",modelValue:d(t).state.activeAudioDevice,"onUpdate:modelValue":[n[5]||(n[5]=a=>d(t).state.activeAudioDevice=a),n[6]||(n[6]=a=>d(t).commit("changeMicrophone"))]},null,8,["items","modelValue"])]),_:1}),i(ee,null,{default:C(()=>[i(K,{label:"Speaker",class:"margin input","hide-details":"auto"})]),_:1})]),_:1})]),_:1})]),_:1}),i(M,{icon:"",class:"center icon",flat:"",onClick:n[7]||(n[7]=a=>L("CHAT"))},{default:C(()=>[rn]),_:1}),i(M,{icon:"",class:"center icon",flat:"",onClick:n[8]||(n[8]=a=>L("GALLERY"))},{default:C(()=>[vn]),_:1}),i(M,{class:"center leave-button",onClick:T},{default:C(()=>[J("Leave")]),_:1})])]))}});const fn=ke(mn,[["__scopeId","data-v-a2b8af59"]]),Sn=Se({__name:"InCall",setup(e){const{mobile:t}=We(),u=w(t&&window.innerHeight>window.innerWidth);return(c,I)=>d(t)?u.value?(x(),Q(Ya,{key:1})):(x(),Q(fn,{key:2})):(x(),Q(la,{key:0}))}});export{Sn as default};
